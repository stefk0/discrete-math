\chapter{Релации}
\index{релация}

За да дадем определение на понятието релация, трябва първо 
да въведем понятието декартово произведение на множества,
което пък от своя страна се основава на понятието наредена двойка.

\subsection*{Наредена двойка}

За два елемента $a$ и $b$ въвеждаме опрецията {\bf наредена двойка} $\pair{a,b}$.
Наредената двойка $\pair{a,b}$ има следното характеристичното свойство:
\[a_1 = a_2\ \wedge\ b_1 = b_2\ \iff\ \pair{a_1,b_1} = \pair{a_2,b_2}.\]
Понятието наредена двойка може да се дефинира по много начини, стига да изпълнява харектеристичното свойство.
Ето примери как това може да стане:
\begin{enumerate}[1)]
\item
  \marginpar{Norbert Wiener (1914)}
  Първото теоретико-множествено определение на понятието наредена двойка е
  дадено от Норберт Винер:
  \[\pair{a,b} = \{\{\{a\},\emptyset\},\{\{b\}\}\}.\]
\item
  \marginpar{Kazimierz Kuratowski (1921)}
  Определението на Куратовски се приема за ,,стандартно`` в наши дни:
  \[\pair{a,b} = \{\{a\},\{a,b\}\}.\]
\end{enumerate}

\begin{problem}
  Докажете, че горните дефиниции наистина изпълняват харектеристичното свойство за наредени двойки.
\end{problem}

\begin{remark}
  %\marginpar{Пример за рекурсивна дефиниция}
  Сега можем да въведем понятието наредена $n$-орка $\pair{a_1,\dots,a_n}$ за всяко естествено число $n \geq 1$:
  \begin{align*}
    & \pair{a_1} = a_1,\\
    & \pair{a_1,a_2,\dots,a_n} = \pair{a_1,\pair{a_2,\dots,a_n}}
  \end{align*}
\end{remark}
 
\section{Декартово произведение}
\marginpar{На англ. cartesian product}
\index{декартово произведение}
\marginpar{Считаме, че $(A\times B)\times C = A\times (B\times C) = A\times B \times C$}
За две множества $A$ и $B$, определяме тяхното декартово произведение като
\[A\times B = \{\pair{a,b}\mid a\in A\ \&\ b\in B\}.\]
За краен брой множества $A_1,A_2,\dots,A_n$, определяме
\[A_1\times A_2\times\cdots\times A_n = \{\pair{a_1,a_2,\dots,a_n}\mid a_1 \in A_1\ \&\ a_2\in A_2\ \&\ \dots\ \&\ a_n \in A_n\}.\]


\begin{problem}
  Преверете дали:
  \begin{enumerate}[a)]
  \item 
    $A\times(B\cup C) = (A\times B) \cup (A\times C)$;
  \item
    $(A\cup B)\times C = (A\times C)\cup (B\times C)$;
  \item 
    $A\times(B\cap C) = (A\times B) \cap (A\times C)$;
  \item
    $(A \cap B)\times C = (A \times C)\cap(B\times C)$;
  \item 
    $A\times(B\setminus C) = (A\times B) \setminus (A\times C)$;
  \item
    $(A\setminus B)\times C = (A\times C)\setminus (B\times C)$;
  \item
    $(A\triangle B)\times C = (A\times C)\triangle (B\times C)$;
  \item
    $\Ps(A \times B) = \Ps(A) \times \Ps(B)$;
  \end{enumerate}
\end{problem}

\section{Основни видове бинарни релации}
\index{бинарна релация}
% Подмножествата $R$ от вида $R \subseteq A\times A\times\cdots\times A$ се наричат релации.
Релациите от вида $R\ \subseteq\ A\times A$ са важен клас, който ще срещаме често.
Да разгледаме няколко основни вида релации от този клас:
\begin{enumerate}[I)]
\item
  {\bf рефликсивна}, ако
  \[(\forall x\in A)[\pair{x,x}\in R].\]
  Например, релацията $\leq\ \subseteq\ \Nat\times\Nat$ е рефлексивна, защото
  \[(\forall x\in \Nat)[x \leq x].\]
\item
  {\bf антирефлексивна}, ако
  \[(\forall x\in A)[\pair{x,x}\not\in R].\]
  Например, релацията $<\ \subseteq\ \Nat\times\Nat$ е антирефлексивна, защото
  \[(\forall x\in \Nat)[x \not< x].\]
\item
  {\bf транзитивна}, ако
  \[(\forall x,y,z\in A)[\pair{x,y}\in R\ \&\ \pair{y,z}\in R \rightarrow \pair{x,z}\in R].\]
  Например, релацията $\leq\ \subseteq\ \Nat\times\Nat$ е транзитивна, защото
  \[(\forall x,y,z\in A)[x \leq y\ \&\ y \leq z\ \rightarrow\ x\leq z].\]
\item
  {\bf симетрична}, ако
  \[(\forall x,y\in A)[\pair{x,y}\in R \rightarrow \pair{y,x}\in R].\]
  Например, релацията $=\ \subseteq\ \Nat\times\Nat$ е рефлексивна, защото
  \[(\forall x,y\in \Nat)[x = y\ \rightarrow\ y = x].\]
\item
  {\bf антисиметрична}, ако
  \[(\forall x,y\in A)[\pair{x,y}\in R\ \&\ \pair{y,x}\in R \rightarrow x = y].\]
  Например, релацията $\leq\ \subseteq\ \Nat\times\Nat$ е антисиметрична, защото
  \[(\forall x,y,z\in A)[x \leq y\ \&\ y \leq x\ \rightarrow\ x = y].\]
\item
  {\bf асиметрична}, ако
  \[(\forall x,y)[\pair{x,y}\in R \rightarrow \pair{y,x}\not\in R].\]
  Например, релацията $\leq\ \subseteq\ \Nat\times\Nat$ е асиметрична, защото
  \[(\forall x,y\in \Nat)[x < y\ \rightarrow\ y \not< x].\]
\end{enumerate}

\begin{remark}
  Добре е да запомните как се наричат тези основни видове релации, защото ще ги използваме често.
  Обърнете също внимание, че ако една релация {\em не} е рефлексивна, то това не означава, че тя е антирефлексивна.
  Също така, ако една релация {\em не} е симетрична, то това не означава, че тя е антисиметрична или асиметрична.
\end{remark}

\begin{example}
  Да обобщим примерите от по-горе.
  \begin{enumerate}[a)]
  \item
    Релацията $\leq\ \subseteq\ \Nat\times\Nat$ е рефлексивна, транзитивна и антисиметрична.
  \item
    Релацията $<\ \subseteq\ \Nat\times\Nat$ е антирефлексивна, транзитивна и асиметрична.
  \item
    Релацията $=\ \subseteq\ \Nat\times\Nat$ е рефлексивна, транзитивна и симетрична.
  \end{enumerate}
\end{example}

\begin{problem}
  Проверете кои от горе-изброените свойства притежава релацията $R$:
  \begin{enumerate}[a)]
  \item
    \marginpar{Озн. $\Nat^2 = \Nat\times\Nat$}
    $R\subseteq \Nat^2$ и е определна като 
    \marginpar{$a\vert b \iff (\exists k\in\Nat)(b = k\cdot a)$}
    \[(a,b) \in R \iff a | b.\]
  \item
    $R \subseteq \Z\times \Z$ е определена като
    \[(x,y)\in R \iff \mbox{НОД}(x,y) = 1\]% \iff \neg(\exists z > 1)[\ z\vert x\ \wedge\ z\vert y\ ]\]
  \item
    \marginpar{Озн. $\R$ - реалните числа}
    $R\subseteq \Int^2$ и е определена като
    \[(a,b) \in R \iff a\cdot b > 0.\]
  \item
    $R\subseteq \Int^2$ и е определена като 
    \[(a,b) \in R \iff a+b = 0.\]
  \item
    $R\subseteq \Int^2$ и е определена като
    \[(a,b) \in R \iff a+b = 5.\]
  \item
    $R\subseteq \Int^2$ и е определена като 
    \[(a,b) \in R \iff a+b\mbox{ е четно}.\]
  \item
    $R\subseteq (\Int^2)^2$ и е определена като
    \[(\pair{a,b}, \pair{c,d}) \in R \iff a+d = b+c.\]
  \item
    $R\subseteq (\Int^2)^2$ и е определена като
    \[(\pair{a,b},\pair{c,d}) \in R \iff a\cdot d = b\cdot c.\]
  \item
    $R\subseteq (\Int\times (\Int\setminus\{0\}))^2$ и е определена като
    \[(\pair{a,b},\pair{c,d}) \in R \iff a\cdot d = b\cdot c.\]
  \item
    \marginpar{Озн. $\Z$ - целите числа}
    $R_{m}\subseteq \Z^2, m\in \Z, m>0$ и е определена като
    \[\pair{a,b} \in R_m \iff m\mid (a - b).\]
  \item
    $R\subseteq \R^2$ и е определена като 
    \[(x,y) \in R \iff (x-y)\mbox{ е рационално число}.\]
  \item
    \marginpar{Озн. $\Q$ - рационалните числа}
    $R \subseteq \Q^2$ и е определена като
    \[(p,r) \in R\ \iff\ p-r \mbox{ е цяло число}.\]
  \item
    $R \subseteq \Nat^2$ и е определена като
    \[(a,b) \in R \iff a = b \vee a+1 = b.\]
  \item
    $R \subseteq \Nat^2$ и е определена като
    \[\pair{a,b}\in R \iff (\exists k\in\Nat)[a+k = b].\]
  \item
    Нека $\leq_1\ \subseteq\ A^2$ и $\leq_2\ \subseteq\ B^2$ са частични наредби.
    $R \subseteq A^2\times B^2$ е определена като
    \[(\pair{a,b}, \pair{c,d}) \in R \iff a\leq_{1}c\ \wedge\ b\leq_{2}d .\]
  \item
    Нека $\leq_1\ \subseteq\ A^2$ и $\leq_2\ \subseteq\ B^2$ са частични наредби.
    $R \subseteq A^2\times B^2$ е определена като
    \[(\pair{a,b}, \pair{c,d}) \in R \iff a\leq_{1}c\ \vee\ b\leq_{2}d .\]

  \end{enumerate}
\end{problem}

\begin{problem}
  Нека $R$ и $S$ са релации на еквивалентност върху множеството $A$.
  Какви свойства притежават следните релации:
  \begin{enumerate}[a)]
  \item
    $R \cap S$;
  \item
    $R \cup S$;
  \item
    $R \setminus S$;
  % \item
  %   $R \circ S$.
  \end{enumerate}
\end{problem}

\begin{problem}
  Нека $\Sigma = \{1,2,\dots,9\}$ и $n$ е ествествено число.
  Нека $R \subseteq \Sigma^n \times \Sigma^n$, където
  $(\pair{a_1,a_2,\dots,a_n},\pair{b_1,b_2,\dots,b_n}) \in R \iff a_i + 1 \equiv b_1 (\mod 2)$.
\end{problem}

\begin{problem}
  За едно число $x \in \Nat$, нека с $x_{(2)}$ да означаваме най-късия двоичния запис на $n$,
  а с $N_0(x)$ и $N_1(x)$ броя на $0$-лите и съответно броя на $1$-ците в $x_{(2)}$.
  Нека $R \subseteq \Nat\times\Nat$, където
  \begin{enumerate}
  \item 
    $(x,y) \in R$ iff $N_0(x) \leq N_0(y)\ \&\ N_1(x) \leq N_1(y)$.
  \item
    $(x,y) \in R$ iff $N_0(x) = N_0(y)\ \vee\ N_1(x) = N_1(y)$.
  \end{enumerate}
\end{problem}



%% Rosen Textbook
\begin{problem}
  Кои от следните бинарни релации върху множеството на функциите от $\Z$ в $\Z$
  са релации на еквивалентност? Опишете техните класове на еквивалентност.
  \begin{enumerate}[a)]
  \item
    $R = \{(f,g)\mid f(1) = g(1)\}$.
  \item
    $R = \{(f,g)\mid f(0) = g(0)\wedge f(1) = g(1)\}$.
  \item
    $R =\{(f,g)\mid (\forall x\in\Z)[f(x)-g(x) = 1]\}$.
  \item
    $R = \{(f,g)\mid (\exists c\in\Z)(\forall x\in\Z)[f(x)-g(x) = c]\}$.
  \item
    $R = \{(f,g)\mid f(0) = g(1)\wedge f(1) = g(0)\}$.
  \end{enumerate}
\end{problem}

\section{Релации над думи}

\begin{itemize}
\item
  Азбука е крайно множество $\Sigma = \{a_1,\dots,a_n\}$ като елементите $a_i$ на $\Sigma$ наричаме {\bf букви}.
\item
  Нека да фиксираме един елемент $\varepsilon \not\in \Sigma$.
  Сега ще определим {\bf думите} над азбуката $\Sigma$. Това са:
  \begin{itemize}
  \item
    \marginpar{наричаме $\varepsilon$ празната дума}
    $\varepsilon$ е дума над $\Sigma$;
  \item
    \marginpar{т.е. думите са крайни последователности от букви}
    Нека $\alpha$ е дума над $\Sigma$ и $a \in \Sigma$ е буква.
    Тогава $\alpha a$ е дума над $\Sigma$;
  \item
    няма други думи над $\Sigma$.
  \end{itemize}
\item
  Означаваме с $\Sigma^n$ множеството от всички думи с дължина $n$ над азбуката $\Sigma$, $\Sigma^0 = \{\varepsilon\}$,
  защото празната дума е единствената дума с дължина $0$.
\item
  Със $\Sigma^\star$ означаваме множеството от всички думи над азбуката $\Sigma$, т.е.
  \marginpar{$0 \in \Nat$}
  \[\Sigma^\star = \bigcup_{n\in\Nat} \Sigma^{n}.\]
\end{itemize}

Сега ще определим функцията {\bf дължина}\index{дума!дължина} на дума.
\marginpar{Функцията $\abs{\cdot}:\Sigma^\star\to\Nat$ е винаги сюрективна. Кога е биективна?}
Дължината $|\alpha|$ на думата $\alpha \in \Sigma^\star$ се определя с индукция по построението на $\alpha$.
\begin{enumerate}[(i)]
  \item
    Нека $\alpha = \varepsilon$. Тогава $|\alpha| = 0$.
  \item
    Нека $\alpha = \beta a$, за някоя дума $\beta\in \Sigma^\star$ и някоя буква $a\in X$.
    Тогава \[|\alpha| = |\beta| + 1.\]
\end{enumerate}

Определяме функцията {\bf конкатенация}\index{дума!конкатенация} $\cdot$, т.е.
слепване на две думи.
За всеки две думи $\alpha$ и $\beta$ от $\Sigma^\star$ определяме тяхната конкатенация с индукция по дължината $\beta$:
\marginpar{$\cdot:\Sigma^\star\times \Sigma^\star \to \Sigma^\star$ е винаги сюрективна. Може ли да бъде биективна?}
\begin{enumerate}[(i)]
  \item
    $|\beta| = 0$, т.е. $\beta = \varepsilon$.
    Тогава $\alpha\cdot\beta = \alpha$.
  \item
    $|\beta| = n+1$, т.е. $\beta = \gamma b$, за някоя дума $\gamma$, $|\gamma| = n$, и някоя буква $b\in\Sigma$.
    Тогава $\alpha\cdot\beta = (\alpha\cdot\gamma)\cdot b$.
\end{enumerate}

Казваме, че думата $\alpha$ е {\bf начало} на думата $\beta$, ако съществува дума $\gamma \in \Sigma^\star$ такава, че
$\beta = \alpha\cdot\gamma$. Обикновено означаваме $\alpha \preceq \beta$.
Аналогично дефинираме $\alpha$ да бъде {\bf край} на думата $\beta$, ако съществува $\gamma \in \Sigma^\star$ такава, че
$\beta = \gamma \cdot \alpha$.

\begin{problem}
  Нека $\Sigma = \{0,1\}$.
  Какви свойства имат следните бинарни релации над $\Sigma^\star$ ?
  Ако $R$ е релация на  еквивалентност, то опишете нейните класове на еквивалентност 
  и намерете техния брой.
  \begin{enumerate}[a)]
  \item
    $(\alpha,\beta) \in R \iff \alpha \preceq \beta$;
  \item
    $(\alpha,\beta) \in R  \iff (\exists\gamma\in \Sigma^\star)[\exists a,b\in \Sigma)(\gamma a \preceq \alpha\ \&\ \gamma b \preceq \beta\ \&\ a \neq b]$;
  \item
    $(\alpha,\beta) \in R  \iff (\exists\gamma\in \Sigma^\star)[\exists a,b\in \Sigma)(\gamma a \preceq \alpha\ \&\ \gamma b \preceq \beta\ \&\ a < b]$;
  \item
    $(\alpha,\beta) \in R  \iff \alpha \preceq \beta \vee (\exists\gamma\in \Sigma^\star)[\exists a,b\in \Sigma)(\gamma a \preceq \alpha\ \&\ \gamma b \preceq \beta\ \&\ a < b]$;
  \item
    $(\alpha,\beta) \in R \iff |\alpha| = |\beta|\ \& (\forall i \leq |\alpha|)[a_i \leq b_i]$;
  \item
    $(\alpha,\beta) \in R \iff (\forall i \leq \min\{|\alpha|,|\beta|\})[a_i \leq b_i]$;
  \item
    $(\alpha,\beta) \in R \iff (\exists \gamma_1,\gamma_2 \in \Sigma^\star)[\beta = \gamma_1 \alpha \gamma_2]$;
  \item
    за фиксирано число $n$,
    \[(\alpha,\beta) \in R \iff (\exists\gamma\in\Sigma^n)[\gamma\preceq\alpha\ \&\ \gamma\preceq\beta].\]
  \item
    за фиксирано число $n$,
    \[(\alpha,\beta) \in R \iff \alpha = \beta \vee (\alpha \neq \beta\ \&\ (\exists\gamma\in\Sigma^n)[\gamma\preceq\alpha\ \&\ \gamma\preceq\beta]).\]
  \item
    за фиксирано число $n$,
    \[(\alpha, \beta)\in R \iff |\alpha| = |\beta| > n\ \&\ (\forall i > n)[a_i = b_i].\]
  \end{enumerate}
\end{problem}

\begin{problem}
  Да фиксираме две множества $B \subseteq A$. Дефинираме бинарната релация $R$ върху $\Ps(A)$ по следния начин:
  \[R = \{(X,Y) \in \Ps(A)\times\Ps(A) \mid (X \triangle Y) \subseteq B\}.\]
  Докажете, че:
  \begin{enumerate}[a)]
  \item 
    $R$ е релация на еквивалентност;
  \item
    за всяко $X \in \Ps(A)$ съществува точно едно множество $Y \in [X]_R$, за което $Y \cap B = \emptyset$.
  \end{enumerate}
\end{problem}


\section{Операции върху релации}
\begin{enumerate}[I)]
\item
  {\bf Композиция} на две релации $S \subseteq B\times C$ и $T \subseteq A\times B$ е релацията $S\circ T \subseteq A\times C$,
  определена като:
  \[S\circ T = \{\langle{a,c}\rangle \mid (\exists b \in B)[\pair{a,b}\in T\ \&\ \pair{b,c} \in S]\}.\]
\item
  {\bf Обръщане} на релацията $R \subseteq A\times B$ е релацията $R^{-1}\subseteq B\times A$, 
  определена като:
  \[R^{-1} = \{\pair{x,y} \mid \pair{y,x} \in R\}.\]
  \item
  \marginpar{Очевидно е, че $P$ е рефлексивна релация, дори ако $R$ не е.}
  {\bf Рефлексивно затваряне} на релацията $R \subseteq A\times A$ е релацията
  \[P = R \cup \{\pair{a,a} \mid a\in A\}.\]
\item
  {\bf Итерация} на релацията $R \subseteq A\times A$ дефинираме като за всяко естествено число $n$,
  дефинираме релацията $R^n$ по следния начин:
  \marginpar{Лесно се вижда, че  $R^1 = R$}
  \begin{align*}
    R^0 & = A\times A\\
    R^{n+1} & = R^n \circ R.
  \end{align*}
\item
  \marginpar{\ding{45} Проверете, че $R^+$ е транзитивна релация!}
  {\bf Транзитивно затваряне} на $R \subseteq A\times A$ е релацията
  \[R^+ = \bigcup_{n\geq 1} R^n.\]
\end{enumerate}

За дадена релация $R$, с $R^\star$ ще означаваме нейното рефлексивно и транзитивно затваряне.
От дефинициите е ясно, че \[R^\star = \bigcup_{n\geq 0} R^n.\]

\begin{problem}
  Ако $P$ е множеството от всички хора, да разгледаме релациите
  \begin{align*}
    E & = \{\pair{x,y} \in P\times P \mid \text{$x$ е враг на $y$}\},\\
    F & = \{\pair{x,y} \in P\times P \mid \text{$x$ е приятел на $y$}\}.
  \end{align*}
  Ако приемем, че поговорката ,,врагът на моя враг е мой приятел'' е вярна, то 
  какво ни казва това за релациите $E$ и $F$ ?
\end{problem}

\begin{example}
  Да разгледаме релацията $R$ над $\Nat$, за която
  $R = \{\pair{x,y} \in \Nat^2 \mid x+1 = y\}$. Тогава:
  \begin{itemize}
  \item 
    $R^0 = \{\pair{x,x} \mid x\in \Nat\}$;
  \item
    $R^n = \{\pair{x,y} \in \Nat^2 \mid x+n = y\}$, за всяко $n \in \Nat$;
  \item
    $R^+ = \{\pair{x,y}\in\Nat^2 \mid (\exists n\geq 1)[x+n = y]\} = \{\pair{x,y} \in \Nat^2 \mid x < y\}$;
  \item
    $R^\star = \{\pair{x,y} \in \Nat^2 \mid x \leq y\}$.
  \end{itemize}
\end{example}


\begin{problem}
  Дайте пример за релации $R$ и $S$, за които
  \[R\circ S \neq S\circ R.\]
\end{problem}

  
\begin{problem}
  Докажете, че:
  \begin{enumerate}[a)]
  \item
    $R$ е симетрична тогава и само тогава, когато $R^{-1}\subseteq R$;
  \item
    $R$ е транзитивна тогава и само тогава, когато $R\circ R\subseteq R$;
  \item
    $R$ е транзитивна и симетрична тогава и само тогава, когато $R = R^{-1}\circ R$.
\end{enumerate}
\end{problem}
\begin{proof}
  \begin{enumerate}[a)]
  \item
    Задачата се разделя на две подзадачи.
    \begin{enumerate}[(i)]
    \item
      Нека $R$ да бъде симетрична. Ще докажем, че $R^{-1}\subseteq R$, т.е.
      \[(\forall x\forall y)[(x,y)\in R^{-1} \rightarrow (x,y)\in R].\]
      Нека $(x,y)\in R^{-1}$. Тогава по определение имаме, че $(y,x)\in R$ и следователно $(x,y)\in R$,
      защото $R$ е симетрична.
    \item
      Нека $R^{-1}\subseteq R$. Щe докажем, че $R$ е симетрична, т.е.
      \[(\forall x\forall y)[(x,y)\in R \rightarrow (y,x)\in R].\]
      Нека $(x,y)\in R$, следователно по определение $(y,x)\in R^{-1}$.
      Тогава от $R^{-1}\subseteq R$ следва, че $(y,x)\in R$.
    \end{enumerate}
  \item
    Тази задача е лесна.
  \item
    Нека $R^{-1}\circ R = R$. Ще докажем, че $R$
    е симетрична и транзитивна.
    \begin{enumerate}[(i)]
    \item
      Ще докажем, че $R$ e симетрична.
      За целта е достатъчно да вземем произволна двойка $\pair{x,y} \in R$
      и да покажем, че $\pair{y,x} \in R$.
      Нека 
      % \begin{prooftree}
      %   \AxiomC{$\pair{x,y} \in R$}
      %   \RightLabel{\scriptsize($R^{-1}\circ R = R$)}
      %   \UnaryInfC{$\pair{x,y} \in R^{-1}\circ R$}
      %   \UnaryInfC{$(\exists z)[\pair{x,z} \in R\ \wedge\ \pair{z,y} \in R^{-1}]$}
      %   \UnaryInfC{$(\exists z)[\pair{z,x} \in R^{-1}\ \wedge\ \pair{y,z} \in R]$}
      %   \UnaryInfC{$(\exists z)[\pair{y,z} \in R\ \wedge\ \pair{z,x} \in R^{-1}]$}
      %   \UnaryInfC{$\pair{y,x} \in R^{-1}\circ R$}
      %   \RightLabel{\scriptsize($R^{-1}\circ R = R$)}
      %   \UnaryInfC{$\pair{y,x} \in R$}
      % \end{prooftree}
      \begin{align*}
        \pair{x,y} \in R & \iff \pair{x,y} \in R^{-1}\circ R & (\text{имаме, че }R^{-1}\circ R = R)\\
        & \iff (\exists z)[\pair{x,z} \in R\ \wedge\ \pair{z,y} \in R^{-1}]\\
        & \iff (\exists z)[\pair{z,x} \in R^{-1}\ \wedge\ \pair{y,z} \in R]\\
        & \iff (\exists z)[\pair{y,z} \in R\ \wedge\ \pair{z,x} \in R^{-1}]\\
        & \iff \pair{y,x} \in R^{-1}\circ R\\
        & \iff \pair{y,x} \in R.
      \end{align*}
      
      Следователно,
      \[(\forall x,y \in A)[\pair{x,y} \in R\ \rightarrow\ \pair{y,x} \in R].\]
    \item
      Ще докажем, че $R$ e транзитивна.
      За целта е достатъчно да вземем произволни двойки $\pair{x,y} \in R$
      и $\pair{y,z} \in R$, то $\pair{x,z} \in R$.
      
      \begin{prooftree}
      \AxiomC{$\pair{x,y} \in R$}
      \AxiomC{$\pair{y,z} \in R$}
      \RightLabel{\scriptsize($R$ е симетрична)}
      \UnaryInfC{$\pair{z,y} \in R$}
      \UnaryInfC{$\pair{y,z} \in R^{-1}$}
      \BinaryInfC{$\pair{x,z} \in R^{-1}\circ R$}
      \RightLabel{\scriptsize($R^{-1}\circ R = R$)}
      \UnaryInfC{$\pair{x,z} \in R$}
      \end{prooftree}
      Следователно,
      \[(\forall x,y,z \in A)[(\pair{x,y} \in R\ \wedge\ \pair{y,z} \in R) \rightarrow\ \pair{x,z} \in R].\]
    \end{enumerate}
    Нека сега $R$ е транзитивна и симетрична.
    Ще докажем, че $R^{-1}\circ R = R$.
    
    \begin{enumerate}[(i)]
    \item 
      Първо да отбележим, че
      \begin{prooftree}
        \AxiomC{$\pair{x,y} \in R$}
        \AxiomC{$\pair{x,y} \in R$}
        \RightLabel{\scriptsize($R$ е симетрична) }
        \UnaryInfC{$\pair{y,x} \in R$}
        \RightLabel{\scriptsize($R$ е транзитивна) }
        \BinaryInfC{$\pair{x,x} \in R\ \wedge \pair{y,y}\in R$}
      \end{prooftree}
      Следователно,
      \[(\forall x \in Dom(R))[\pair{x,x} \in R].\]
    \item
      Ще докажем, че $R^{-1}\circ R \subseteq R$.
      
      \begin{prooftree}
        \AxiomC{$\pair{x,z}\in R$}
        \AxiomC{$\pair{x,y} \in R^{-1}\circ R$}
        \RightLabel{\scriptsize(Съществува $z$)}
        \UnaryInfC{$\pair{z,y} \in R^{-1}$}
        \UnaryInfC{$\pair{y,z} \in R$}
        \RightLabel{\scriptsize($R$ е симетрична)}
        \UnaryInfC{$\pair{z,y} \in R$}
        \RightLabel{\scriptsize($R$ е транзитивна)}
        \BinaryInfC{$\pair{x,y} \in R$}
      \end{prooftree}
    \item
      Ще докажем, че $R \subseteq R^{-1}\circ R$.
      \begin{prooftree}
        \AxiomC{$\pair{x,y}\in R$}
        \AxiomC{$\pair{x,y}\in R$}
        \RightLabel{\scriptsize(От (i))}
        \UnaryInfC{$\pair{y,y} \in R$}
        \UnaryInfC{$\pair{y,y} \in R^{-1}$}
        \RightLabel{\scriptsize(по деф.)}
        \BinaryInfC{$\pair{x,y} \in R^{-1}\circ R$}
      \end{prooftree}
    \end{enumerate}
  \end{enumerate}
  
\end{proof}

\begin{problem}
  Нека $\{\pair{a,b}\}\subseteq R$, за някои $a\neq b$.
  Докажете, че ако $R$ е симетрична, то $R$ не е антисиметрична.
\end{problem}
% \begin{proof}
%   Нека $R$ е симетрична.
% \end{proof}

\begin{problem}
  Нека $R$ да бъде релация на еквивалентност върху $B$ и $f:A\to B$.
  Дефинираме множеството 
  \[Q = \{((x,y)\in A\times A\mid (f(x),f(y))\in R\}.\]
  Докажете, че $Q$ е релация на еквивалентност.
\end{problem}

\begin{problem}
  Нека $R$ е релация върху $A$.
  Да определим релациите:
  \begin{itemize}
  \item 
    $S = \{\pair{x,y}\mid \pair{x,y} \in R\ \wedge\ \pair{y,x} \in R\}$;
  \item
    $T = \{\pair{x,y} \mid \pair{x,y}\in R\ \wedge\ \pair{y,x}\not\in R\}$.
  \end{itemize}
  Докажете, че:
  \begin{enumerate}[a)]
  \item 
    $S$ е симетрична и $T$ е антисиметрична.
  \item
    $\pair{x,y} \in R\ \iff\ (\pair{x,y}\in S \vee \pair{x,y} \in T)$;
  \item
    ако $R$ е транзитивна, то $S$ и $T$ са също транзитивни, но обратната посока не е вярна.
  \end{enumerate}
\end{problem}

Нека $R \subseteq A\times A$ е бинарна релация.
Да определим множеството $[x]_R$ като
\[[x]_R = \{y\in A\mid \pair{x,y} \in R\}.\]
\index{клас на еквивалентност}
Ако $R$ е релация на еквивалентност и $x\in Field(R)$, то наричаме множеството $[x]_R$ {\bf клас на еквивалентност} за $x$ относно релацията $R$.

\begin{example}
  Нека $S$ е множеството от всички студенти, които живеят в Студентски град.
  Да разгледаме следната бинарна релация над $S$:
  \[R = \{\pair{x,y} \in S \times S \mid \text{$x$ живее в същия блок като $y$}\}.\]
  Лесно се съобразява, че $R$ е релация на еквивалентност.
  Тогава всеки блок в Студентски град определя отделен клас на еквивалентност.
  Елементите на такъв клас са всички студенти, които живеят в съответния блок.
\end{example}

\begin{example}
  \marginpar{$x \equiv y \mod 4 \iff (\exists k \in \Z)(x = y + 4\cdot k)$}
  Нека $\sim_4\ \subseteq\ \Nat\times \Nat$ е бинарна релация, дефинирана като
  \[x\sim_4 y \iff x\equiv y \mod 4.\]
  $\sim_4$ е релация на еквивалентност и има четири класа на еквивалентност
  \[[0]_{\sim_4}, [1]_{\sim_4}, [2]_{\sim_4}, [3]_{\sim_4}.\]
\end{example}

\begin{problem}
  Да дефинираме релацията $R \subseteq \R\times \R$ като:
  \[\pair{x,y}\in R \iff (x-y)\in\Z.\]
  Намерете множествата $[1]_R$ и $[\frac{1}{2}]_R$.
\end{problem}

\newpage
\section{Наредби}
Обикновено се изучават релации притежаващи различни комбинации от горните свойства. 
Сега ще изброим няколко основни вида релации (понякога се наричат наредби).
Релацията $R \subseteq A\times A$ се нарича:
\begin{itemize}
\item
  \marginpar{На англ. partial order}
  {\bf частична наредба}, ако тя е рефлексивна, транзитивна и антисиметрична.
  Например, $\leq$ е частична наредба.
  Също така, релацията $\subseteq$ между множества е частична наредба.
\item 
  \marginpar{На англ. equivalence relation}
  {\bf релация на еквивалентност}, ако тя е рефлексивна, транзитивна и симетрична.
  Например, $=$ е релация на еквивалентност.
\item
  \marginpar{На англ. linear order}
  {\bf линейна наредба}\index{наредба!линейна}, ако $R$ е частична наредба, 
  и за всеки два елемента $x,y$ точно едно от $\pair{x,y} \in R$, $x = y$, $\pair{y,x}\in R$ е изпълнено.
\item
  \marginpar{На англ. well-founded order}
  {\bf фундирана наредба}\index{наредба!фундирана}, 
  ако всяко непразно подмножество $X\subseteq A$ притежава поне един {\em минимален} елемент, т.е.
  \[(\forall X\subseteq A)[X\neq\emptyset \rightarrow (\exists m\in X)\neg(\exists y\in X)[\pair{y,m} \in R]].\]
\item
  \marginpar{На англ. well-ordered relation}
  {\bf добра наредба}\index{наредба!добра}, ако всяко непразно подмножество $X\subseteq A$ има {\em най-малък} елемент , т.е.
  \[(\forall X\subseteq A)[X\neq\emptyset \rightarrow (\exists m\in X)(\forall y\in X)[\pair{m,y}\in R \vee m = y]].\]
\item
  \marginpar{На англ. lexicographical order}
  {\bf лексикографска наредба} върху частичната наредба $(X,<)$ ще наричаме 
  наредбата $(X\times X,\prec)$, където
  \[\pair{x,y}\prec\pair{x^\prime,y^\prime}\ \iff\ x<x^\prime\ \vee\ (x = x^\prime\ \wedge\ y < y^\prime).\]
\end{itemize}

\begin{remark}
  Обърнете внимание на разликата между понятията {\em минимален} и {\em най-малък} елемент относно релацията $R$.
  \begin{itemize}
  \item $x_0$ е {\bf минимален} елемент за множеството $X \subseteq A$ относно $R$,
    ако не съществуват елементи $y \in X$, за които $\pair{y,x}\in R$, т.е.
    \[(\forall y \in X)[\pair{y,x} \not\in R].\]
  \item $x_0$ е {\bf най-малък} елемент за множеството $X \subseteq A$ относно $R$,
    ако за всеки друг елемент $y \in X$ е изпълнено $\pair{x,y}\in R$, т.е.
    \[(\forall y \in X)[x\neq y \rightarrow \pair{x,y} \in R].\]
  \end{itemize}
\end{remark}

\begin{problem}
  Да се докаже, че $(\Nat^2,\prec)$ е добре наредено множество.
\end{problem}

\begin{problem}
  Докажете, че следните две условия за частично наредено множество $(X,<)$ са еквивалентни:
  \begin{enumerate}[a)]
  \item
    всяко непразно подмножество на $X$ има минимален елемент;
  \item
    не съществува строго намаляваща редица $x_1>x_2>x_3>\dots$ то елементи на $X$.
  \end{enumerate}
\end{problem}

\begin{problem}
  Да се докаже, че частично нареденото множество $(X,<)$ е добре наредено тогава и само тогава, когато 
  $(X,<)$ е фундирано и $<$ е линейна наредба върху $X$.
\end{problem}

\begin{problem}% от СЕП
  Кои от изброените множества са фундирани? Кои са добре наредени?
  \begin{enumerate}[a)]
  \item
    $(\Nat,<)$;
  \item
    $(\Z,<)$;
  \item
    $(X^*, <)$, където за $\alpha,\beta\in X^*$, $\alpha < \beta \iff \alpha\mbox{ е поддума на }\beta$;
  \item
    $(2^\Nat,\subsetneq)$;
  \item
    $(Fin(\Nat),\subsetneq)$, където $Fin(\Nat)$ е съвкупността от всички крайни подмножества на $\Nat$;
  \item
    $(\Nat^+,|)$, където $m|n \iff m\neq n\ \&\ m\mbox{ дели }n$.
  \end{enumerate}
\end{problem}

\begin{problem}
  Докажете, че подмножество на всяка антисиметрична релация е също антисиметрична.
\end{problem}





%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "discrete-math"
%%% End: 
