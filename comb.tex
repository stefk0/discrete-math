\chapter{Комбинаторика}

\section{Основни понятия}

\begin{description}
\item[(0+R+)]
  {\bf Конфигурации с подредба и с повторение.}
  Също така се наричат пермутации с повторение.
  Това е броят $P_r(n,k)$ на всички думи с дължина $k$ над $n$-елементна азбука.
  \[P_r(n,k) = n^k\]
  С тази формула можем да намираме всички $k$-буквени думи над азбука с $n$ букви.
  Например, всички 4-буквени думи над азбуката $\{a,b,c\}$ са $3^4$ на брой.
  Иначе казано, това са всички начини да изберем по една буква от всяка урна:
  \[
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      \end{array}
    \right)
  \]
  и ги подреждаме в редица.
\item[(0+R--)]
  \marginpar{Тук $k \leq n$.}
  {\bf Конфигурации с подредба, но без повторение.}
  Съща така се наричат пермутации.
  Това е броят $P(n,k)$ на думите с дължина $k$ над азбука с $n$ букви, като нямаме повторения на буквите.
  \[P(n,k) = n(n-1)\cdots(n-k+1) = \frac{n!}{(n-k)!}.\]
  Например, всички 3-буквени думи {\em без повторения} над азбуката $\Sigma = \{a,b,c,d\}$
  са $4!3!2!$ на брой.
  Как можем да генерираме всички такива 3-буквени думи?
  Започваме с 3 пълни урни:
  \[
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      d
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      d
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      b\\
      c\\
      d
      \end{array}
    \right)
  \]
  От първата урна избираме произволен елемент измежду 4-те букви. Например $b$.
  Това ще бъди първият символ на нашата дума. Понеже той не може да се повтаря,
  ние премахваме $b$ от другите урни. Оставаме с втора и трета урна:
  \[
  \left(\begin{array}{c}
      a\\
      c\\
      d
      \end{array}
    \right)
  \left(\begin{array}{c}
      a\\
      c\\
      d
      \end{array}
    \right).
    \]
    От втората урна избираме произволен елемент измежду 3-те останали букви.
    Нека да изберем от втората урна $a$.
    Това означава, че нашата дума ще започва с $ba$.
    Отново, понеже не искаме $a$ да се повтаря, премахваме $a$ от третата урна. Оставаме само с третата урна:
      \[
      \left(\begin{array}{c}
          c\\
          d
        \end{array}
      \right).
    \]
    За третата буква от нашата дума избираме измежду $c$ и $d$.
    Нека да изберем $d$.
    Така генерирахме думата $bad$.
  \item[(0--R--)]
  {\bf Конфигурации без подредба и без повторение.}
  \marginpar{Тук също $k \leq n$.}
  \marginpar{Също така се наричат комбинации}
  Това е броят $C(n,k)$ на $k$-елементните подмножества (т.е. елементите {\em не са подредени}) на едно $n$-елементно множество.
  Имаме следната връзка с пермутации без повторение:
  \[P(n,k) = C(n,k)\cdot P(k,k),\] 
  т.е. за да получим всички думи с дължина $k$ {\em без повторения на буквите},
  можем първо да изберем едно множество от $k$ букви и след това да ги подредим тези $k$ на брой букви в една редица.
  Следователно,
  \marginpar{$\binom{n}{k}$ - чете се $n$ над $k$}
  \[C(n,k) =  \frac{P(n,k)}{P(k,k)} = \frac{n!}{(n-k)!k!} = \binom{n}{k}.\]
  Например, всички $3$ елементни подмножества на $\{1,2,3,4\}$ са
  \[\{1,2,3\},\{1,2,4\},\{1,3,4\},\{2,3,4\}.\]

  Като друг пример, броят на всички комбинации от правилно попълнени фишове в тото 6 от 49 са $\binom{49}{6}$.
  Всеки правилно попълнен фиш еднозначно се определя като множество от 6 елемента измежду числата $\{1,2,\dots,49\}$,
  защото не е важен реда на попълване на числата.
\item[(0-- R+)]
  {\bf Комбинации без подредба и с повторение.}
  Мултимножество е съвкупност от обекти, в които позволяваме повторение на елементи.
  Например, $\{3,1,1,2\}$ е мултимножество и $\{3,1,1,2\} = \{2,1,3,1\}$,
  но $\{3,1,2\} \neq \{3,1,1,2\}$.
  Броят на $n$-елементните мулти-подмножества на едно $k$-елементно множество е:
  \[C(n+k-1,k-1) = \binom{n+k-1}{k-1}.\]
  Нека да видим как можем да достигнем до тази формула като намерим всички 4-елементни мулти-подмножества
  на $\{a,b,c\}$. Ще видим, че на всяко такова мулти-множество можем да съпоставим редица от 6 кутии,
  като в две от тези кутии са отбелязани с $\star$, а в другите кутии са буквите от азбуката, избрани по следния начин - 
  в кутиите до първата $\star$ поставяме $a$; в кутиите между двете $\star$ поставяме $b$; и в кутиите след втората $\star$
  поставяме $c$.
  Например, на следната редица от кутии:
  
  \begin{tabular}{|l|l|l|l|l|l|}
    \hline
    a & a & $\star$ & $\star$ & c & c \\
    \hline
  \end{tabular}  
  съответства мулти-множеството $\{a,a,c,c\}$, а на редицата от кутии:

  \begin{tabular}{|l|l|l|l|l|l|}
    \hline
    a & $\star$ & b & $\star$ & c & c \\
    \hline
  \end{tabular}
  съответства мулти-множеството $\{a,b,c,c\}$
  
  Всяка такава подредба се определя еднозначно от позициите на двете $\star$.
  Следователно, всички мулти-множества са $\binom{4+3-1}{3-1} = \binom{6}{2}$.
\end{description}



\begin{problem}
  Отговорете на следните въпроси:
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $2^8$}
    Колко битови низове с дължина един байт има ?
  \item
    Колко са всички подмножества на множеството $A$ с $8$ елемента ?
  \item 
    \marginpar{Отг. $2^5$}
    Колко битови низове с дължина един байт започват с 1 завършват с 00 ?
  \item
    \marginpar{Отг. $62! - 52!$}
    Всеки потребител на една компютърна система има парола, която е дълга между 6 и 8 символа.
    Всеки символ е малка или голяма буква, или цифра.
    Всяка парола трябва да съдържа поне една цифра.
    Колко такива пароли има?
  \item
    \marginpar{Отг. $4!$}
    По колко начина можем да подредим елементите $\{a,b,c,d\}$ ?
  \item 
    \marginpar{Отг. $5!$}
    Колко думи може да се образуват от буквите в $ABCDEFG$, които съдържат $ABC$.
  \item
    \marginpar{Отг. $\binom{11}{1}\binom{10}{4}\binom{6}{4}\binom{2}{2}$}
    Колко различни думи могат да се образуват като разместим буквите на думата $MISSISSIPPI$?
  \item
    Колко различни думи могат да се образуват като разместим буквите на думата $TENNESSEE$?
  \item
    Колко различни думи могат да се образуват като разместим буквите на думата $SUCCESS$?
  \item
    Колко различни думи могат да се образуват като разместим буквите на думата АБРАКАДАБРА?
  \item
    Колко различни думи могат да се образуват като разместим буквите на думата ПЕРПЕРИКОН?
  \item
    \marginpar{Отг. $10\cdot 9\cdot 8$}
    В състезание участват 10 отбора. 
    По колко начина могат да се разпределят златните, сребърните и бронзовите медали?
  \item
    \marginpar{Не искаме числата да започват с нула. Отг. $5! - 4!$}
    Колко различни петцифрени числа могат да се образуват чрез разместване на цифрите от 0,1,2,3,4?
  \item
    \marginpar{Отг. $\binom{8}{1}\binom{7}{3}\binom{4}{4}$}
    По колко различни начина могат да се настанят осем студенти в три стаи съответно с едно, три и четири легла?
  \item
    %\marginpar{Отг. $\binom{n}{1}\binom{n-1}{1}\binom{n-2}{1}\binom{n-3}{1}$}
    По колко различни начина четирима младежи могат да поканят на танц четири от $n$ девойки?
  \item
    %\marginpar{Отг. $\binom{6}{2}\binom{4}{2}\binom{2}{2}$}
    Шест различни предмета се боядисват по следния начин: два зелен, два червен, два син цвят.
    По колко различни начина могат да се боядисат предметите?  
  \item
    По колко различни начина могат да се разпределят 10 специалисти в 4 цеха така, че в тях да попаднат съответно по 1,2,3 и 4 души?
  \item
    \marginpar{Отг. $(n+1)! - n! - n!$}
    Иванчо и $n$ негови приятели отиват на кино.
    По колко различни начина могат всички да седнат заедно на един ред, така че Иванчо е винаги
    между двама негови приятели.
  \item
    \marginpar{Отг. $\binom{m}{k}\binom{N-M}{n-k}$}
    В партида от $N$ изделия, $M$ са бракувани.
    По колко различни начина могат да се вземат от партидата $n$ изделия, така че точно $k$ от тях да бъдат бракувани ($M\leq N, k\leq n\leq N$)?
  \item
    \marginpar{Отг. $\binom{4}{2}\binom{48}{4}$}
    От колода с 52 карти се изваждат 6 произволни карти без връщане.
    По колко различни начина могат да се извадят картите, така че две от тях да са дами?
  \item
    \marginpar{Отг. $\binom{4}{2}\binom{4}{2}\binom{44}{2}$}
    От колода с 52 карти се изваждат 6 произволни карти без връщане.
    По колко различни начина могат да се извадят картите, така че две от тях да са тройки и две осмици?
  \item
    \marginpar{Отг. $\binom{48}{24}\binom{4}{2}$}
    По колко различни начина може да се раздели колода от 52 карти на две пачки от по 26 карти така, че във всяка от тях да има по две дами?
  \item
    \marginpar{Отг. $\binom{8}{2}\binom{6}{2}\binom{4}{2}\binom{2}{2}$}
    По колко начина може да се разпределят 8 подаръка между 4 лица, така че всеки да получи по два подаръка?
  \item
    %\marginpar{Отг. $\binom{40}{1}\binom{39}{1}\binom{38}{5}$}
    Провежда се събрание с $40$ присъстващи.
    По колко начина може да се избере председател, секретар и 5 членна комисия?
  \end{enumerate}
\end{problem}


\begin{problem}
  От колода с $52$ карти се избират $11$. По колко различни начина могат да се изберат извадки, в които се срещат:
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $\binom{48}{10}\binom{4}{1}$}
    точно $1$ ас;
  \item
    \marginpar{Отг. $\binom{52}{11} - \binom{48}{11} - \binom{48}{10}\binom{4}{1}$}
    поне $2$ валета;
  \item
    \marginpar{Отг. $\binom{39}{7}\binom{13}{4}$}
    точно $4$ пики;
  \item
    \marginpar{Отг. $\binom{52}{11} + \binom{39}{10}\binom{13}{1} + \binom{39}{9}\binom{13}{2}$}
    най-много $2$ кари;
  \item
    \marginpar{Отг. $\binom{3}{2}\binom{12}{2}\binom{36}{7} + \binom{3}{1}\binom{12}{1}\binom{36}{8}$}
    точно $2$ аса и $2$ точно трефи;
  \item
    точно $2$ аса и не повече от $2$ трефи;
  \end{enumerate}
\end{problem}

\begin{problem}
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $\binom{6}{2}$}
    Колко е максималният брой прави, които могат да се прекарат през 6 точки?
  \item
    \marginpar{Отг. $\binom{10}{2} - 2$}
    Колко е максималният брой прави, които могат да се прекарат през 10 точки, три от които лежат на една права? 
  \item
    \marginpar{Отг. $\binom{7}{2}$}
    В колко точки се пресичат 7 прави от една равнина, никои три от които не минават през една точка и никои две не са успоредни?
  \item
    \marginpar{Отг. $\binom{n}{2}$}
    Колко е максималният брой точки, в които се пресичат $n$ прави от една равнина?
  \item
    \marginpar{$\binom{n-3}{2} + 3(n-3) = \binom{n}{2} - \binom{3}{2}$}
    Колко е максималният брой точки, в които се пресичат $n$ прави от една равнина, като три от тези прави са успоредни?
  \item
    \marginpar{$\binom{n-4}{2} + 4(n-4)+1 = \binom{n}{2} - (\binom{4}{2} - 1)$}
    Колко е максималният брой точки, в които се пресичат $n$ прави от една равнина, като четири прави минават през една и съща точка?
  \item
    \marginpar{$\binom{n}{2} - (\binom{4}{2} - 1) - \binom{3}{2}$}
    В колко точки се пресичат $n$ прави от една равнина, като три от тези прави са успоредни и четири други минават през една и съща точка.
\end{enumerate}
\end{problem}





% \begin{problem}
%   Докажете, че:
%   \begin{enumerate}[a)]
%   % \item
%   %   $(x+y)^n = \sum^{n}_{i=0}\binom{n}{i}x^iy^{n-i}$;
%   \item
%     $2^n = \sum^n_{k=0}\binom{n}{k}$;
%   \item
%     $3^n = \sum^n_{k=0}2^n\binom{n}{k}$;
%   \item
%     $\binom{n}{k} = \binom{n}{n-k}$;
%   \item
%     $\binom{n+1}{k} = \binom{n}{k} + \binom{n}{k-1}$
%   \item 
%     $\binom{n+m}{r} = \sum^r_{k=0}\binom{n}{r-k}\binom{m}{k}$;
%   \item
%     $\binom{2n}{n} = \sum^n_{k=0}\binom{n}{k}^2$;
%   \item
%     $\binom{n+1}{r+1} = \sum^n_{j=r}\binom{j}{r}$;
%   \item
%     $\binom{2n}{2} = 2\binom{n}{2} + n^2$;
%   \item
%     $\binom{n+r+1}{r} = \sum^r_{k=0}\binom{n+k}{k}$;
%   \item
%     $n2^{n-1} = \sum^{n}_{k=1} k\binom{n}{k}$;
%   \item
%     $n\binom{2n-1}{n-1} = \sum^{n}_{k=1}k\binom{n}{k}^2$;
%   \end{enumerate}
% \end{problem}

\begin{problem}
  \marginpar{Един метод за доказателство е с индукция по $n$. Ние ще разгледаме друг метод.}
  Докажете, че
  \[\sum^n_{k=0}\binom{n}{k}k = n2^{n-1}.\]
\end{problem}
\begin{proof}
  Нека за определеност да положим $A = \{a_1,\dots,a_n\}$.
  Ще докажем задачата като преброим по два пъти един и същ клас от обекти.% , а именно
  % $\Bs = \{\pair{a,B} \mid a\in A\ \&\ B \in \Ps(A)\ \&\ a \not\in B\}$.
  \marginpar{Да означим $\Ps_k(A) = \{B \subseteq A \mid \abs{B} = k\}$ и да напомним, че $\abs{\Ps_k(A)} = \binom{n}{k}$}
  \begin{itemize}
  \item 
    Дясната страна на тъждеството можем да представим по следния начин:
    \[\sum^n_{i=1}\abs{\{B \in \Ps(A) \mid a_i \not\in B\}} = \sum^{n}_{i=1}2^{n-1} = n2^{n-1}.\]
  \item
    Това ни подсказва, че за лявата страна, можем да използваме наблюдението, че
    \begin{align*}
      \sum^n_{i=1}\abs{\{B \in \Ps(A) \mid a_i \not\in B\}} & = \sum^n_{i=1}\sum^n_{k=0}\abs{\{B \in \Ps_k(A) \mid a_i \not\in B\}}\\
      & = \sum^n_{k=0}\sum^n_{i=1}\abs{\{B \in \Ps_k(A) \mid a_i \not\in B\}}.
    \end{align*}
    Да разгледаме всяко $k$ поотделно като използваме тъждеството:
    \[\Ps(A) = \bigcup^n_{k=0}\Ps_k(A).\]
    \begin{itemize}
    \item 
      \marginpar{$\Ps_0(A) = \{\emptyset\}$}
      За $k = 0$ получваме, че  
      \[\sum^n_{i=1}\abs{\{B \in \Ps_0(A) \mid a_i \not\in B\}} = \sum^n_{i=1}1 = \binom{n}{n}n.\]
    \item 
      \marginpar{Да напомним, че \[\binom{n}{k} = \binom{n}{n-k}\]}
      За $k = 1$ получваме, че
      \begin{align*}
        \sum^n_{i=1}\abs{\{B \in \Ps_1(A) \mid a_i \not\in B\}} & = \sum^n_{i=1}\binom{n-1}{1}\\
        & = n\binom{n-1}{n-2}\frac{n-1}{n-1}\\
        & = \binom{n}{n-1}(n-1).
      \end{align*}
    \item
      Да видим дали можем да получим за $k = 2$ формула сходна с тази за $k = 0$ и $k =1$.
      \begin{align*}
        \sum^n_{i=1}\abs{\{B \in \Ps_2(A) \mid a_i \not\in B\}} & = \sum^n_{i=1}\binom{n-1}{2}\\
        & = n\binom{n-1}{n-3}\frac{n-2}{n-2}\\
        & = \binom{n}{n-2}(n-2).
      \end{align*}
    \item
      Сега вече имаме добра идея какъв вид трябва да намерим за произволно $k < n$:
      \begin{align*}
        \sum^n_{i=1}\abs{\{B \in \Ps_k(A) \mid a_i \not\in B\}} & = \sum^n_{i=1}\binom{n-1}{k}\\
        & = n\binom{n-1}{n-1-k}\frac{n-k}{n-k}\\
        & = \binom{n}{n-k}(n-k).
      \end{align*}
    \item
      Да разгледаме накрая и случая $k = n$:
      \marginpar{$\Ps_n(A) = \{A\}$}
      \[\sum^n_{i=1}\abs{\{B \in \Ps_n(A) \mid a_i \not\in B\}} = \sum^n_{i=1}0 = 0 = \binom{n}{0}\cdot 0.\]
  \end{itemize}
  Да обединим всички случаи за $k$, получаваме лявата страна:
  \begin{align*}
    \sum^n_{k=0}\sum^n_{i=1}\abs{\{B \in \Ps_k(A) \mid a_i \not\in B\}} & = \sum^n_{k=0} \binom{n}{n-k}(n-k)\\
    & = \sum^{n}_{k=0}\binom{n}{k}k.
  \end{align*}
\end{itemize}
\end{proof}

\section{Принцип на включването и изключването}

\begin{prop}
  За две крайни множества $A$ и $B$,
  \begin{enumerate}[a)]
  \item 
    ако $A \cap B = \emptyset$, то $\abs{A\cup B} = \abs{A} + \abs{B}$.
  \item
    ако $A\subseteq B$, то $\abs{B\setminus A} = \abs{B} - \abs{A}$.
  \item
    $\abs{A\cup B} = \abs{A} + \abs{B} - \abs{A\cap B}$.
  \end{enumerate}
\end{prop}
\begin{proof}
  \begin{enumerate}[a)]
  % \item
  %   Индукция по броя на елементите на $B$.
  %   \begin{itemize}
  %   \item
  %     $\abs{B} = 0$, то $B = \emptyset$ и тогава за произволно множество $А$,
  %     \[\abs{A\cup B} = \abs{A} + \abs{B}.\]
  %   \item
  %     $\abs{B} = 1$, то $B = \{b\}$ и тогава за произволно крайно множество $A$, за което $b \not\in A$,
  %     е очевидно, че \[\abs{A\cup\{b\}} = \abs{A} + 1.\]
  %   \item
  %     $\abs{B} = n+1$, то $B = B^\prime \cup \{b\}$, $\abs{B^\prime} = n$ и 
  %     нека $A$ е произволно крайно множество, за което $A \cap B = \emptyset$.
  %     \begin{align*}
  %       \abs{A \cup B} = \abs{(A \cup B^\prime) \cup \{b\}} = \abs{A\cup B^\prime} + 1 = \abs{A} + \abs{B^\prime} + 1 = \abs{A} + \abs{B}.
  %     \end{align*}
  %   \end{itemize}
  % \item
  %   Ако $A \subseteq B$, то $B\setminus A\ \cup\ A = B$ и $B\setminus A\ \cap\ A = \emptyset$. Тогава от a):
  %   \begin{align*}
  %     \abs{B} = \abs{B\setminus A\ \cup\ A} = \abs{B\setminus A} + \abs{A}.
  %   \end{align*}
  %   Следователно,
  %   \[\abs{B\setminus A} = \abs{B} - \abs{A}.\]
  \item[в)]
    Имаме, че:
    \begin{align*}
      A\cup B & = A \setminus B\ \cup\ (A\cap B)\ \cup\ B\setminus A\\
      & = A\setminus (A\cap B)\ \cup\ (A\cap B)\ \cup\ B\setminus (A\cap B)
    \end{align*}
    Трите множества в дясната страна на равенството са непресичащи се.
    Тогава, използвайки а) и б), 
    \begin{align*}
      \abs{A \cup B} & = \abs{ A\setminus (A\cap B)} + \abs{A\cap B} + \abs{B\setminus (A\cap B)}\\
      & = \abs{A} - \abs{A\cap B} + \abs{A \cap B} + \abs{B} - \abs{A\cap B}\\
      & = \abs{A} + \abs{B} + \abs{A \cap B}
    \end{align*}
  \end{enumerate}
\end{proof}

\begin{prop}
  Докажете, че за всеки три крайни множества $A$, $B$ и $C$,
  \[\abs{A\cup B \cup C} = \abs{A}+\abs{B}+\abs{C} - \abs{A\cap B} - \abs{B\cap C} - \abs{A\cap C}+ \abs{A\cap B \cap C}.\]
\end{prop}
\begin{proof}
  \begin{align*}
    \abs{(A \cup B) \cup C} & = \abs{A \cup B} + \abs{C} - \abs{(A\cup B)\cap C}\\
    & = (\abs{A} + \abs{B} - \abs{A\cap B}) + \abs{C} - \abs{(A\cap C)\cup(B\cap C)}\\
    & = \abs{A} + \abs{B} + \abs{C} - \abs{A\cap B} - (\abs{A\cap C} + \abs{B\cap C} - \abs{(A\cap C) \cap (B\cap C)})\\
    & = \abs{A} + \abs{B} + \abs{C} - \abs{A\cap B} - \abs{A\cap C} - \abs{B\cap C} + \abs{A\cap B \cap C}
  \end{align*}
\end{proof}


\begin{framed}
\begin{thm}
  Нека $A_1\dots A_n$ са $n$ на брой крайни множества и $n\geq 2$. Тогава:
  \begin{align*}
    |A_1\cup A_2\cup \dots \cup A_n| = & \sum^n_{i=1} |A_i| - \sum_{i < j} |A_{i}\cap A_{j}| + \\
    & \sum_{i < j < k} |A_{i}\cap A_{j}\cap A_{k}|- \dots + (-1)^{n-1}|A_1 \cap A_2\dots \cap A_n|.    
  \end{align*}
\end{thm}
\end{framed}

\begin{problem}
  Колко решения в естествените числа имат уравненията:
  \begin{enumerate}[a)]
  \item
    $x_1+x_2+x_3 = 15$;
  \item
    $x_1 + x_2 + x_3 = 15$, като $x_2 < 3$;
  \item
    % \marginpar{Отг. $\binom{13}{2} - \binom{12}{1} - \binom{11}{1} - \binom{10}{1}$}
    $x_1 + x_2 + x_3 = 15$, като $x_2 \geq 3$;
  \item
    $x_1+x_2+x_3 = 15$, като $x_1 \geq 2\ \&\ x_2 \geq 3$;
  \item
    $x_1+x_2+x_3 = 15$, като $x_1 \geq 2\ \&\ x_2 \geq 3\ \&\ x_3 \leq 8$;
  \item
    $x_1+x_2+x_3+x_4 = 25$, като $x_1 < 2\ \vee\ x_2 \geq 3$;
  \item
    $x_1+x_2+x_3+x_4 = 25$, като $x_1 < 2\ \vee\ x_2 = 3$;
  \item
    $x_1+x_2+x_3+x_4 = 25$, като $x_1 < 2\ \vee\ x_2 < 3$;
  \end{enumerate}
\end{problem}
\begin{solution}
  \begin{enumerate}[a)]
  \item
    Търсим броят на елементите на 
    \[A = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\}.\]
    Това са всички $15$ елементни мултимножества на  $\{x_1,x_2,x_3\}$.
    Например, мултимножеството $\{x_1,x_1,x_3,x_2,x_1,x_3\}$ отговаря на решение на уравнението $x_1 + x_2 + x_3 = 6$,
    където $x_1 = 3$, $x_2 = 1$, $x_3 = 2$.
    Следователно,
    \[\abs{A} = \binom{15 + 3 - 1}{3-1}.\]
  \item
    Търсим броя на елементите на 
    \begin{align*}
      A_2 =\ &\{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_2 < 3\}\\
      =\ & \{(x_1,0,x_3) \in \Nat^3\mid x_1 + 0 + x_3 = 15\}\ \cup \\ 
      & \{(x_1,1,x_3) \in \Nat^3\mid x_1 + 1 + x_3 = 15\}\ \cup \\ 
      & \{(x_1,2,x_3) \in \Nat^3\mid x_1 + 2 + x_3 = 15\}.
    \end{align*}
    Лесно се съобразява, че
    \[\abs{A_2} = \binom{16}{1} + \binom{15}{1} + \binom{14}{1}.\]
  \item
    Отговорът е
    \[\abs{A} - \abs{A_2} = \binom{17}{2} - \binom{16}{1} - \binom{15}{1} - \binom{14}{1}.\]
    Друг начин да решим задачата е като съобразим, че 
    \[x_2 \geq 3 \iff x_2 + 3 \geq 0.\]
    Това означава, че търсим броя на решенията на уравнението
    \[x_1 + (x_2 + 3) + x_3 = 15 \iff x_1 + x_2 + x_3 = 12.\]
    \marginpar{Проверете, че $\binom{14}{2} = \binom{17}{2} - \binom{16}{1} - \binom{15}{1} - \binom{14}{1}$}
    Това означава, че отговорът е $\binom{14}{2}$.
  \item
    Първо ще дадем едно доказателство, което е полезно за да упражним принципа за включването и изключването.
    След това ще видим, че по-лесно можем да решим задачата като използваме идеята от доказателството на в).
    Да разгледаме множествата:
    \begin{align*}
      A & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\},\\
      A_1 & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_1 < 2\},\\
      A_2 & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_2 < 3\}.
    \end{align*}
    Ние търсим колко елемента има множеството 
    \[B = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_1 \geq 2\ \&\ x_2 \geq 3\}.\]
    Понеже \[B = (A\setminus A_1) \cap (A\setminus A_2) = A \setminus (A_1 \cup A_2),\]
    трябва да намерим $\abs{A}$ и $\abs{A_1 \cup A_2}$. Тогава отговорът на задачата е:
    \[\abs{B} = \abs{A} - \abs{A_1 \cup A_2}.\]

    Лесно се вижда, че:
    \begin{align*}
      & \abs{A}  = \binom{17}{2} = 136\\
      & \abs{A_1} = 16 + 15 = 31\\
      & \abs{A_2} = 16 + 15 + 14 = 45\\
      & \abs{A_1\cap A_2} = 6.
    \end{align*}
    Освен това, от принципа за включването и изключването, 
    \[\abs{A_1 \cup A_2} = \abs{A_1} + \abs{A_2} - \abs{A_1\cap A_2} = 31 + 45 - 6 = 70.\]

    Следователно, отговорът е 
    \[\abs{B} = \abs{A} - \abs{A_1 \cup A_2} = 136 - 70 = 66.\]

    За второ решение, достатъчно е да намерим броя на решенията на уравнението:
    \[(x_1 + 2) + (x_2 + 3) + x_3 = 15 \iff x_1 + x_2 + x_3 = 10.\]
    Това означава, че отговорът е $\binom{12}{2} = 66$.
  % \item[д)]
  %   Използваме същата идея и означения както в горната задача.
  %   Да разгледаме множествата:
  %   \begin{align*}
  %     A & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\},\\
  %     A_1 & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_1 < 2\},\\
  %     A_2 & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_2 < 3\},\\
  %     A_3 & = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_3 > 8\}.
  %   \end{align*}
  %   Тук търсим колко елемента има множеството
  %   \[B = \{(x_1,x_2,x_3) \in \Nat^3\mid x_1 + x_2 + x_3 = 15\ \&\ x_1 \geq 2\ \&\ x_2 \geq 3\ \&\ x_3 \leq 8\}.\]
  %   Понеже
  %   \[B = (A \setminus A_1) \cap (A\setminus A_2) \cap (A\setminus A_3) = A \setminus (A_1 \cup A_2 \cup A_3),\]
  %   трябва да намерим $\abs{A}$ и $\abs{A_1 \cup A_2 \cup A_3}$.
  %   Тогава отговорът на задачата е 
  %   \[\abs{B} = \abs{A} - \abs{A_1 \cup A_2 \cup A_3}.\]
  %   Лесно се вижда, че:
  %   \begin{align*}
  %     & \abs{A}  = 136\\
  %     & \abs{A_1} = 16 + 15 = 31\\
  %     & \abs{A_2} = 16 + 15 + 14 = 45\\
  %     & \abs{A_3} = 7 + 6 + 5 + 4 + 3 + 2 + 1 = 28\\
  %     & \abs{A_1\cap A_2} = 2.3 = 6\\
  %     & \abs{A_1\cap A_3}  = 7 + 6 = 13\\
  %     & \abs{A_2\cap A_3}  = 7 + 6 + 5 = 18\\
  %     & \abs{A_1\cap A_2\cap A_3} = \abs{A_1 \cap A_2} = 6.
  %   \end{align*}
  %   Сега от принципа за включването и изключването, 
  %   \begin{align*}
  %     \abs{A_1 \cup A_2 \cup A_3} & = \abs{A_1} + \abs{A_2} + \abs{A_3} - \abs{A_1 \cap A_2} - \abs{A_1 \cap A_3} - \abs{A_2 \cap A_3} + \abs{A_1 \cap A_2 \cap A_3}\\
  %     & = 31 + 45 + 28 - 6 - 13 - 18 + 6 = 73
  %   \end{align*}
  %   Следователно, отговорът е:
  %   \[\abs{B} = \abs{A} - \abs{A_1\cup A_2 \cup A_3} = 136 - 73 = 63.\]
  \item[е)]
    Да означим
    \begin{align*}
      A_1 & = \{(x_1,x_2,x_3,x_4)\in\Nat^4 \mid x_1+x_2+x_3+x_4 = 25\ \&\ x_1 < 2\}\\
      A_2 & = \{(x_1,x_2,x_3,x_4)\in\Nat^4 \mid x_1+x_2+x_3+x_4 = 25\ \&\ x_2 \geq 3\}.
    \end{align*}
    Тогава от принципа за включването и изключването, отговорът е 
    \[|A_1 \cup A_2| = |A_1| + |A_2| - |A_1 \cap A_2|.\]
  \end{enumerate}
\end{solution}


% \begin{problem}
%   Дайте комбинаторно доказателство на 
%   \begin{enumerate}[1)]
%   \item
%     $n! = \sum^{n}_{k=0}(-1)^k\binom{n}{k}(n-k)^n$
%   \item
%     $\binom{x+a}{n} = \sum^{k}_{i=0}\binom{x}{i}\binom{a}{n-i}$
%   \end{enumerate}
% \end{problem}

% \begin{problem}
%   \begin{enumerate}[a)]
%   \item
%     \marginpar{Отг. $\binom{n+4-1}{4-1}$}
%     По колко начина могат да се изберат $n$ монети от купчина монети с номинал 5, 10, 20 и 50 стотинки?
%   % \item
%   %   %\marginpar{Отг. }
%   %   По колко начина могат да се изтеглят $13$ от $52$ карти, ако ги различаваме само по цвета?
%   \item
%     %\marginpar{Отг. $\binom{n+m-1}{m-1}$}
% Намерете броя на възможните начини за разпределение на $n$ {\bf неразличими} топки в $m$ различни кутии.
% \item
%     %\marginpar{Отг. $\binom{(n-m)+m-1}{m-1}$}
%     Намерете броя на възможните начини за разпределение на $n$ {\bf неразличими} топки в $m$ различни кутии, 
%     ако няма празна кутия.
%   \item
%     %\marginpar{Отг. $\binom{n+m-1}{m-1} - \binom{(n-m)+m-1}{m-1}$}
%     Намерете броя на възможните начини за разпределение на $n$ {\bf неразличими} топки в $m$ различни кутии,
%     ако съществува поне една празна кутия.
%   \item
%     %\marginpar{$\binom{n+m-1}{m-1}/m!$ ???}
%     Да се намери броя на възможните начини за разпределения на $n$ {\bf неразличими} топки в $m$ {\bf неразличими} кутии.
%   % \item
%   %   %\marginpar{}
%   %   Да се намери броя на възможните начини за разпределения на $n$ {\bf различими} топки в $m$ различни кутии.
%   \end{enumerate}
% \end{problem}

% \begin{problem}
%   Множеството от всички двоични вектори от $\{0,1\}^{n}$, които във фиксирани $n-k$ позиции имат равни значения,
%   ги наричаме $k$-равнини, за $k\leq n$.
%   \begin{enumerate}[a)]
%   \item
%     \marginpar{Отг. $2^{k}$}
%     Колко различни вектора има в една $k$-равнина?
%   \item
%     \marginpar{Отг. $2^{n-k}\binom{n}{n-k}$}
%     Колко различни $k$-равнини има в $\{0,1\}^{n}$?
%   \item
%     \marginpar{Отг. $\binom{n}{n-k}$}
%     Колко различни $k$-равнини съдържат даден фиксиран $n$-мерен вектор?
%   % \item
%   %   %\marginpar{Отг. $$}
%   %   Колко различни $k$-равнини съдържат дадена $l$-равнина, $0\leq l < k$.
%   \end{enumerate}
% \end{problem}



\begin{problem}
  Да фиксираме множеството $U = \{u_1,u_2\dots,u_n\}$.
  Намерете броя на елементите на следните множества:
  \begin{enumerate}[a)]
  \item 
    $S = \{(X,Y) \mid X \subseteq Y \subseteq U\}$;
  \item
    $S = \{(X,Y,Z) \mid X \subseteq Y \subseteq Z \subseteq U\}$;
  \item
    $S = \{(X,Y,Z) \mid X,Y,Z \subseteq U\ \&\ X \cap Y \cap Z = \emptyset\}$.
  \item
    $S = \{(X,Y,Z) \mid X,Y,Z \subseteq U\ \&\ X\cap Y = \emptyset\ \&\ X \cap Z = \emptyset\ \&\ Y \cap Z = \emptyset\}$;
  \end{enumerate}
\end{problem}
\begin{hint}
  \begin{enumerate}[a)]
  \item 
    За всяко $k = 0,\dots,n$, да разгледаме
    \[S_k = \{(X,Y) \mid X \subseteq Y \subseteq U\ \&\ \abs{X} = k\}.\]
    Съобразете, че:
    \begin{itemize}
    \item 
      за $k \neq k'$, $S_k \neq S_{k'}$;
    \item
      $\abs{S} = \abs{\bigcup^n_{k=0} S_k} = \sum^n_{k=0}\abs{S_k}$.
    \item
      $\abs{S_0} = 2^n$;
    \item
      $\abs{S_1} = n.2^{n-1}$;
    \item
      $\abs{S_k} = \binom{n}{k}2^{n-k}$, за всяко $k = 0,1,\dots,n$.
    \end{itemize}
    Тогава отговорът е
    \[\abs{S} = |\bigcup^n_{k=0} S_k| = \sum^n_{k=0} |S_k| = \sum^n_{k=0} \binom{n}{k}1^k.2^{n-k} = (1+2)^n = 3^n.\]
    
    Сега да видим, че тази задача може да се реши по-лесно ако интерпретираме всеки елемент от вида $(X,Y) \in S$
    като една дума над азбуката $\Sigma = \{XY$, $\bar{X}Y$, $X\bar{Y}$, $\bar{X}\bar{Y}\}$.
    Единственото нещо, което трябва да съобразим е, че нямаме букви от вида $X\bar{Y}$, защото това ще означава, че 
    $X \not\subseteq Y$. Така свеждаме задачата до въпроса колко са всички думи с дължина $n$ над азбука с три букви.
    Ясно е, че отговорър е $3^n$.
  \end{enumerate}
\end{hint}


\section{Комбинаторни задачи за функции}

\begin{problem}
  \marginpar{Отг. $\binom{11}{5}$}
  Нека $(a_1,a_2,\dots,a_{12})$ е пермутация на числата от 1 до 12, за които е изпълнено условието:
  \[a_1 > a_2 > a_3 > a_4 > a_5 > a_6 < a_7 < a_8 < a_9 < a_{10} < a_{11} < a_{12}.\]
  Намерете броя на тези пермутации.  
\end{problem}

\begin{problem}
  Да фиксираме естествените числа $m$ и $n$.
  Една функция \[f:\{1,\dots,n\}\to\{1,\dots,m\}\] е монотонно ненамаляваща, ако
  \[(\forall i\forall j)[1\leq i<j\leq n \rightarrow f(i)\leq f(j)].\]
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $\binom{n+m-1}{m-1}$}
    Колко такива функции съществуват?
  \item
    \marginpar{Във всяка кутийка има топка. Отг. $\binom{(n-m)+m-1}{m-1}$}
    Колко от тези функции са сюрективни при $n\geq m$?
  \item
    \marginpar{Отг. $\binom{m}{n}$}
    Колко от тези функции са инективни при $n\leq m$?
  \end{enumerate}
\end{problem}

\begin{problem}
  Да разгледаме функциите от вида $f:A\to B$,
  където $\abs{A} = k$, $\abs{B} = n$.
  \begin{enumerate}[a)]
  \item 
    \marginpar{Отг. $n^k$}
    Колко са всички тези функции?
  \item
    \marginpar{Само ако $k\leq n$, $n!/(n-k)!$}
    Колко от тези функции са инективни?
  \item
    \marginpar{$\binom{n+k-1}{k-1}$}
    Колко от тези функции са монотонно ненамаляващи?
  \item
    \marginpar{Само ако $n = k$, $n!$}
    Колко от тези функции са биективни?
  \item
    \marginpar{Това е по-трудно.}
    Колко от тези функции са сюрективни?
  \end{enumerate}
\end{problem}


\begin{problem}
  Да разгледаме функциите от вида $f:A\to B$, където $\abs{A} = k$, $\abs{B} = n$.
  Колко от тези функции са сюрективни?
\end{problem}
\begin{solution}
  Нека $B = \{b_1,b_2,\dots,b_n\}$.
  Да означим с $F$ всички функции от вида $f:A\to B$.
  \marginpar{$Range(f) = \{f(a) \mid a\in A\}$}
  \[F_i = \{f:A\to B\mid b_i \not\in Range(f)\}.\]
  Да означим с $S$ сюрективните функции $f:A\to B$.
  Понеже сюрективните функции са тези, за които $Range(f) = B$, то
  \[S = F\setminus(F_1\cup F_2 \cup \dots \cup F_n).\]
  Лесно се съобразява, че имаме следните равенства:
  \begin{align*}
    & \abs{F} = n^k\\
    & \abs{F_i} = (n-1)^k\\
    & \abs{F_i \cap F_j} = (n-2)^k\\
    & \sum^n_{i=1}\abs{F_i} = n.(n-1)^k\\
    & \sum_{i < j}\abs{F_i \cap F_j} = \binom{n}{2}(n-2)^k\\
    & \sum_{i < j < l}\abs{F_i \cap F_j \cap F_l} = \binom{n}{3}(n-3)^k\\
    & \quad \vdots
  \end{align*}
  Прилагайки принципа на включването и изключването, получаваме:
  \begin{align*}
    \abs{S} & = \abs{F} - \sum_i \abs{F_i} + \sum_{i < j}\abs{F_i\cap F_j} - \sum_{i < j < l}\abs{F_i \cap F_j \cap F_l} + \dots \\
    & = n^k - \binom{n}{1}(n-1)^k + \binom{n}{2}(n-2)^k - \binom{n}{3}(n-3)^k + \dots\\
    & = n^k + (-1)^1\binom{n}{1}(n-1)^k + (-1)^2\binom{n}{2}(n-2)^k + (-1)^3\binom{n}{3}(n-3)^k + \dots\\
    & = \sum^n_{i=0}(-1)^i\binom{n}{i}(n-i)^k
  \end{align*}
\end{solution}

Сега ще видим едно приложение на горната задача.

\begin{problem}
  \marginpar{Колко са сюрективните функции $f:A\to B$, като $\abs{A} = 7$, $\abs{B}=3$?}
  Нека да имаме 7 топки с номер на всяка от тях и нека имаме 3 различни кутии, отново номерирани.
  По колко начина можем да поставим топките в кутиите, така че във всяка кутия да има поне по една топка ?
\end{problem}

\begin{remark}
  Да разгледаме множествата $A=\{1,2,\dots,n\}$ и $\Sigma = \{a_1,a_2,\dots,a_k\}$.
  Тогава имаме следните преводи между езика на функциите и езика на думите и азбуките.
  \newline
  \begin{tabular}{|l|l|}
    \hline
    функциите от вида $f:A\to \Sigma$ & думите с дължина $n$ над азбуката $\Sigma$ \\
    \hline
    \hline
    {\bf всички} такива функции & {\bf всички} такива думи\\
    \hline
    {\bf инективните} функции, $n \leq k$ & думите  {\bf без повторения на букви} \\
    \hline
    {\bf сюрективните} функции, $n \geq k$ & думите, в които {\bf всяка буква се среща} \\
    \hline
    {\bf биективните} функции, $n = k$ & думите, в които всяка буква от $\Sigma$ се \\
    & среща {\bf точно веднъж} \\
    \hline
  \end{tabular}

  % Да разгледаме две произволни множества $A = \{1,2,\dots,n\}$ и $B=\{1,2,\dots,k\}$.
  % Да напмним, че една функция $f:A \to B$ е {\bf монотонно ненамаляваща}, ако
  % \[(\forall i\forall j)[1\leq i<j\leq n \rightarrow f(i)\leq f(j)].\]
  % Тогава имаме следните еквивалентни преводи между езика на функциите и езика на кутиите и топките:
  % \newline
  % \begin{tabular}{|l|l|}
  %   \hline
  %   мон. ненамаляващите $f:A\to B$ & \\
  %   \hline
  %   \hline
  %   {\bf всички} такива функции & {\bf всички} такива думи\\
  %   \hline
  %   {\bf инективните} функции при $n \leq k$ & думите, в които {\bf няма повторения на букви} \\
  %   \hline
  %   {\bf сюрективните} функции при $n \geq k$ & във всяка кутия има поне една топка\\
  %   \hline
  %   {\bf биективните} функции при $n = k$ & {\bf всяка буква се среща точно веднъж} \\
  %   \hline
  % \end{tabular}

\end{remark}

% \subsection{Пълно разбъркване на множество}
% \marginpar{На англ. derangement}
% Нека $A = \{a_1,\dots a_n\}$ е произволно множество от $n$ елемента.
% Една пермутация $f$ на елементите на $A$ наричаме {\bf пълно разбъркване}, 
% ако $f$ няма неподвижни точки, т.е. $(\forall a\in A)[f(a)\neq a]$.
% % Можем да означим едно пълно разбъркване $f$ на $A$ 
% % като редицата $(a_{i_1},a_{i_2},\dots,a_{i_n})$,
% % където $f(j) = a_{i_j}$.
% \begin{example}
%   Нека $A = \{1,2,3\}$. Да изредим всички пълни разбърквания на $A$:
%   \[ (2,3,1), \quad  (3,1,2)\]
%   \end{align*}
%   Нека сега $A = \{1,2,3,4\}$. Пълните разбърквания на $A$ са:
%   \begin{align*}
%     & (2,1,4,3), \quad (2,4,1,3), \quad (2,3,4,1)\\
%     & (3,1,4,2), \quad (3,4,1,2), \quad (3,4,2,1)\\
%     & (4,1,2,3), \quad (4,3,2,1), \quad (4,3,1,2)\\
%   \end{align*}
% \end{example}

% \begin{problem}
%   Напишете програма, която намира всички пълни разбърквания на зададено като вход множество $A$.
% \end{problem}


% \begin{problem}
%   Означаваме с $D(n)$ всички пълни разбърквания на едно множество с $n$ елемента.
%   \begin{enumerate}[a)]
%   \item
%     Докажете, че $D(n) - nD(n-1) = (-1)^{n}$ за $n \geq 2$.
%   \item
%     Намерете $D(n)$.
% \end{enumerate}
% \end{problem}
% \begin{proof}
%   \begin{enumerate}[a)]
%   \item
%     Доказателството е с индукция по $n$.
%     Лесно се  съобразява, че имаме това свойство за $n=2$, 
%     защото $D(2) = 1$, а $D(1) = 0$.
    
%     Да приемем, че твърдението е вярно за $n > 2$, като примем, че то е вярно за $n-1$.
%     Нека $A = \{a_1,a_2,\dots,a_n\}$ и да фиксираме последния елемент $a_n$ на $A$.
%     Да означим $B = A\setminus\{a_n\}$.
%     %$B$ имат $D(n-1)$ разбърквания.
%     Да разгледаме едно пълно разбъркване на $B$, $\pi(i) = a_i$, $i = 1,\dots,n-1$.
% %    \[\pi = [a_{i_1}, a_{i_2},\dots, a_{i_{n-1}}].\]
%     Ако заменим $\pi(j)$ с $a_n$ и поставим $\pi(j)$ на $n$-та позиция, то получаваме разбъркване $\rho$ на $A$.
%     Това можем да направим за всяко $ 1 \leq j \leq n-1$ и всяко разбъркване на $B$ и получаваме всеки път ново разбъркване на $A$.
%     Това са общо $(n-1)D(n-1)$ разбърквания.

%     За съжаление, това не са всички пермутации, които ни трябват.
%     Нека сега $\pi_i$ е пермутация на $B$, която има точно една неподвижна точка и $\pi_i(i) = a_i$.
%     Като сменим $a_i$ с $a_n$ и поставим $a_i$ на $n$-та позиция, то получаваме ново разбъркване на $A$.
%     Лесно се съобразява, че разбъркванията получени по този начин са $(n-2)D(n-2)$ 
%     и с това се изчерпват начините за генериране на разбърквания на $A$ от пермутациите на $B$.   

%     Следователно, \[D(n) = (n-1)D(n-1) + (n-2)D(n-2).\]
%     От индукционното предположение знаем, че \[D(n-1) = (n-1)D(n-2) + (-1)^{n-1}.\]
%     Като заместим, получаваме \[D(n) = (n-1)D(n-1) + D(n-1) - (-1)^{n-1},\]
%     което ни дава крайния резултат \[D(n) = nD(n-1) + (-1)^{n}.\]
        
%   \item
%     Може да се реши и с индукция, използвайки предишната подточка.
%     Ще дадем директно рещение като приложим принципа за включване и изключване.
%     Да означим с $P$ броят на всички пермутации на $A$.
%     Да означим с $P_i$ броят на пермутациите, които запазват $i$-тия елемент от $A$.
%     Следователно,
%     \begin{align*}
%       D(n) =\ & |P\setminus{(P_1\cup P_2 \cup \dots \cup P_n)}|\\
%       =\ & |P| - |P_1\cup P_2 \cup \dots \cup P_n|\\
%       =\ & |P| - \sum^n_{i = 1}|P_i| + \sum_{i < j }|P_i\cap P_j| - \dots \\
%       =\ & n! - \sum^n_{i = 1}(n-1)! + \sum_{i<j} (n-2)! - \dots\\
%       =\ & \binom{n}{0}n! + (-1)\binom{n}{1}(n-1)! + (-1)^2\binom{n}{2}(n-2)! - \dots\\
%       =\ & \sum^n_{k=0}(-1)^k\binom{n}{k}(n-k)!
%     \end{align*}
%   \end{enumerate}
% \end{proof}

% \begin{problem}
%   Дадени са $n$ кутии и $m$ неразличими топки.
%   По колко начина могат да се разпределят всички топки в кутиите, така че нито в една кутия да няма повече от $r$ топки?
% \end{problem}
% \begin{proof}
%   Първо, нека отбележим, че $r.n \geq m$. В противен случай, няма да можем да разпределим всички топки в кутиите.
%   Имаме $S = \binom{n+m-1}{n-1}$ общо начини за разпределяне на топките, без ограничение за брой топки в една кутия.
 
%   Да разгледаме едно от тези разпределения на топките.
%   Нека при него във всяка кутия има $r_i$ топки и $\sum^{n}_{i=1} r_i = m$.
%   Нека $p = \lfloor{\frac{m}{r}}\rfloor$.
%   Ясно е, че не може да има повече от $p$ кутии с повече от $r$ топки.
 
%   \begin{enumerate}
%     \item
%       Ако в $i$-тата кутия има повече от $r$ топки, т.е. $r_i = (r+1)+r'_i$, то 
%       броят на различните начини за разпределения на $m-(r+1)$ топки в $n$ кутии е 
%       \[S_1 = \binom{n}{1}\binom{m-(r+1)+(n-1)}{n-1}.\]
%       $S_1$ е броят на разпределенията с поне една кутия с повече от $r$ топки.
%     \item
%       Ако в $i$-тата и $j$-тата кутии има повече от $r$ топки, т.е.
%       $r_i = (r+1)+r'_i, r_j = (r+1)+r'_j$.
%       Тогава броят на различните разпределения на $m-2(r+1)$ топки в $n$ кутии е
%       \[S_2 = \binom{n}{2}\binom{m-2(r+1)+(n-1)}{n-1}.\]
%       $S_2$ е броят на разпределенията с поне две кутии с повече от $r$ кутии.
%     \item
%       Продължаваме да дефинираме $S_i$ до $i=p$.
%   \end{enumerate}

%   Накрая от принципа за включването и изключването получаваме, че крайният резултат е $S + \sum^{p}_{i=1}(-1)^{i}S_i$.
% \end{proof}


\section{Принцип на Дирихле}
\begin{problem}%[\cite{rosen}, стр. 351]
  В един месец от 30 дни се провежда баскетболен турни, в който се играе поне един мач на ден, но всички мачове са не повече от 45.
  Покажете, че има период от последователни дни от месеца, в който се провеждат точно 14 мача.
\end{problem}
\begin{proof}
  Нека $a_j$ означава сумата на всички проведени мачове в първите $j$ дни на месеца.
  Търсим такива $i<j$, че $a_j - a_i = 14$.
  От условието следва, че редицата $a_1,a_2,\dots, a_{30}$ е строго монотонно растяща и
  \[(\forall j)[0\leq j\leq 30 \rightarrow a_j \leq 45].\]
  Ясно е също, че редицата $a_1+14,a_2+14,\dots,a_{30}+14$ е строго монотонно растяща.
  Образуваме редица от 60 елемента $a_1,\dots,a_{30},a_1+14,\dots,a_{30}+14$, като 
  всеки елемент на редицата приема стойност от 1 до 59.
  Тогава от принципа на Дирихле следва, че съществуват два елемента на редицата, които са равни.
  Първите 30 са различни са различни помежду си, вторите 30 елемента също са различни помежду си.
  Следователно, $a_i = a_j + 14$ за някои $i,j$.
  Тогава в дните от $j$ до $i$ са проведени точно 14 мача.
\end{proof}

\begin{problem}%[\cite{rosen}, стр. 351]
  Нека имаме редица $a_0,\dots,a_n$от $n+1$ произволни числа, ненадвишаващи $2n$.
  Покажете, че трябва да съществува $i$ такова, че $a_i\vert a_j$ за някое $j\neq i$.
\end{problem}
\begin{proof}
  Да представим всеки от елементите на редицата $a_j = 2^{k_j}q_j$, където $q_j$ е нечетно.
  Да разгледаме редицата от нечетни числа $q_0,\dots,q_n$, като имаме и условието $q_i \leq 2n$.
  Имаме само $n$ нечетни числа в интервала $[0,2n]$, следователно $q_i = q_j = q$, за някои $i,j$.
  Тогава $a_i = 2^{k_i}q$ и $a_j = 2^{k_j}q$ и е ясно, че или $a_i\vert a_j$ или $a_j\vert a_i$.  
\end{proof}

% \begin{lemma}
%   Нека имаме редица от $n^2 + 1$ различни реални числа $a_1,a_2,\dots a_{n^2+1}$.
%   Тогава съществува подредица с дължина $n+1$, която е или монотонно растяща или монотонно намаляваща.
% \end{lemma}
% \begin{proof}
%   Искаме да намерим индекси $1\leq i_1<i_2<\dots i_{n+1}\leq n^2+1$, за които или $a_{i_1}<a_{i_2}<\dots< a_{i_{n+1}}$ или
%   $a_{i_1}>a_{i_2}>\dots> a_{i_{n+1}}$.

%   Нека за всяко $1\leq i \leq n^2+1$ да означим с $\eta_i$ дължината на най-дългата монотонно растяща редица, която започва от $a_i$.
%   Ако имаме за някое $i$, $\eta_i \geq n+1$, то сме готови.
%   Иначе, от принципа на Дирихле, съществува $1\leq j \leq n$, редица $i_1<i_2<\dots<i_m$ за $m \geq \lceil{\frac{n^2+1}{n}}\rceil = n+1$ и
%   $\eta_{i_1} = \eta_{i_2} = \dots = \eta_{i_m} = j$.
%   Ако $a_{i_k} < a_{i{k+1}}$, то тогава $\eta_{i_k}\geq j+1$, което е противоречие.
%   Следователно, $a_{i_k} > a_{i{k+1}}$ и така получаваме монотонно намаляваща редица $a_{i_1} > a_{i_2} > \dots > a_{i_m}$, която има дължина поне $n+1$.
% \end{proof}

\begin{problem}
  Нека имаме редица от $n$ произволни, не непременно различни, естествени числа $a_1,\dots,a_n$.
  Тогава има подредица от последователни елементи $a_i,a_{i+1},\dots,a_{j}$, за които
  $n | (\sum^{j}_{k=i}a_k)$.
\end{problem}
\begin{proof}
  Да разгледаме редицата от $n+1$ елемента:
  \[\sum^0_{i=1}a_i,\sum^1_{i=1}a_i,\dots,\sum^n_{i=1}a_i.\]
  Тъй като има $n$ различни остатъка при деление на $n$, то от принципа на Дирихле следва, че 
  има поне два елемента $\sum^l_{i=1}a_i, \sum^k_{i=1}a_i$, за $l<k$, които дават един и същ остатък при деление на $n$.
  Получаваме, че \[n|(\sum^l_{i=1}a_i - \sum^k_{i=1}a_i)\ \Rightarrow\ n|(\sum^k_{i=l+1}a_i).\]
\end{proof}

\section{Допълнителни задачи}

\begin{problem}
  Отговорете на следните въпроси:
  \begin{enumerate}[a)]
  \item
    \marginpar{$2.10!10!$}
    По колко начина могат $n$ момчета и $n$ момичета да седнат на ред с $2n$ стола, като няма двама от един пол седящи един до друг?
  \item
    \marginpar{$2.10!10! - 2.7.3!3!$}
    По колко начина могат $n$ момчета и $n$ момичета да седнат на ред с $2n$ стола, като няма двама от един пол седящи един до друг и Иванчо и Марийка не седят един до друг? 
  \item
    \marginpar{Отг. $2.(n-1)!$}
    По колко различни начина могат да се подредят на рафт $n$ книги, така че две от тях, определени предварително, да са една до друга?
  \item
    \marginpar{Отг. $\frac{n!}{2n}$}
    Колко различни гердана могат да се направят от $n$ различни перли, като се използват всичките?
  \item
    \marginpar{Отг. $2.(n-2)(n-3)!$}
    На хоро в кръг са хванали общо $n$ души, между които и Иванчо и Марийка.
    Колко са възможните подредби, при които Иванчо и Марийка са един до друг?
 \item
    На хоро в кръг са хванали общо $n$ души, между които и Иванчо и Марийка.
    Колко са възможните подредби, при които Иванчо и Марийка не са един до друг?
  \item
    \marginpar{Отг. $2^n(n-1)!$}
    Имаме $n$ съпружески двойки, които седят на $2n$ места около една кръгла маса. 
    По колко начина могат да седнат всички двойки, ако ротациите се броят за едно и също подреждане, и
    всеки мъж седи до половинката си.
  \item
    \marginpar{Това е както при герданите}
    Две сядания на една кръгла маса не са различни, ако всеки от седящите има едни и същи съседи.
    По колко различни начина могат да седнат около една кръгла маса:
    \begin{enumerate}
    \item
      \marginpar{Отг. $\frac{(n-1)!}{2}$}
      $n (\geq 2)$ човека;
    \item
      \marginpar{Отг. $\frac{2n!n!}{2.2n} = \frac{n!(n-1)!}{2}$}
      $n$ мъже и $n$ жени, като двама души от един и същ пол не седят един до друг.
    \end{enumerate}
  \end{enumerate}
\end{problem}

\begin{problem}
  \marginpar{Тази задача мисля, че трябва да бъде при включването и изключването}
  Да разгледаме азбуката $\Sigma = \{a_1,\dots,a_n\}$.
  Да се намерят всички $k$-буквени думи над азбуката $\Sigma$, за $k \leq n$, където:
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $\frac{n!}{(n-k)!}$}
    нито една буква не се повтаря;
  \item
    \marginpar{Отг. $n^{\lceil{\frac{k}{2}}\rceil}$}
    са палиндроми;
  \item
    \marginpar{Отг. $n(n-1)^{k-1}$}
    нямат две последователни еднакви букви;
  \item
    \marginpar{Отг. $n^k - n(n-1)^{k-1}$}
    имат две последователни еднакви букви;
  \item
    \marginpar{Отг. $\binom{k}{2}n\cdot\frac{(n-1)!}{(n-1-(k-2))!}$}
    съществува само една буква, която се среща точно два пъти;
  \item
    \marginpar{Отг. $n^k - \frac{n!}{(n-k)!}$}
    съществува буква, която се повтаря;
  % \item
  %   \marginpar{Отг. $\binom{k}{3}n(n-1)^{k-3}$}
  %   съществува буква, която се среща точно три пъти;
  % \item
  %   \marginpar{Отг. $2\binom{k}{2}(n-2)^{k-2}$}
  %   буквите $a, b\in \Sigma$ се срещат точно по веднъж;
  \end{enumerate}
\end{problem}


\begin{problem} % Гаврилов стр. 265, зад. 7
  Нека $U$ е множество от $n$ елемента, $n\geq 3$. За всяко множество $X\subseteq U$, с $\overline{X}$ означаваме $U\setminus X$.
  Също така, за множества $X$ и $Y$, понякога ще пишем $XY$ вместо $X \cap Y$.
  Намерете броя на елементите на следните множества:
  \begin{enumerate}[a)]
  \item
    \marginpar{Отг. $4^n$}
    $\{(X,Y) \mid X,Y\subseteq U\}$
  \item
    \marginpar{Отг. $2\binom{n}{1} 2^{n-1}$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert = 1\}$;
  \item
    \marginpar{Отг. $2^2\binom{n}{2}2^{n-2}$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert = 2\}$;
  \item
    \marginpar{Отг. $4^n - 3^{n}$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert \geq 1\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert = k\}$ за произволно $k \leq n$;
  \item
    \marginpar{Отг. $3^{n} + \binom{n}{1} 3^{n-1}$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert \leq 1\}$;
  \item
    \marginpar{Отг. $\binom{n}{1}\binom{n}{1} = n^2$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \vert{X}\vert = 1\ \&\ \vert{Y}\vert = 1\}$;
  \item
    \marginpar{Нямаме буква $XY$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ X \cap Y = \emptyset\}$;
  \item
    \marginpar{Една буква $XY$. Отг. $\binom{n}{1}3^{n-1}$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \abs{X \cap Y} = 1\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \abs{X \cap Y} = k\}$ за произволно $k \leq n$;
  \item
    \marginpar{Отг. $2\binom{n}{1}2^{n-1} = n2^n$}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ \abs{(X\setminus Y) \cup (Y\setminus X)} = 1\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ X\cap Y = \emptyset\ \&\ |X|\geq 1\ \&\ |Y|\geq 1\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ X\cap Y = \emptyset\ \&\ |X|\geq 2\ \&\ |Y|\geq 2\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ |X\setminus Y| = 1\}$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ |X\setminus Y| = k\}$ за произволно $k \leq n$;
  \item
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ |(X\setminus Y)\cup(Y\setminus X)| = 1\ \&\ |X|\geq 2\ \&\ |Y|\geq 2\}$;
  \item
    \marginpar{Използвайте принципа за вкл. и изкл.}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ X\cap Y = \emptyset\ \&\ |X|\geq 2\ \&\ |Y|\geq 3\}$;
  \item
    \marginpar{Използвайте принципа за вкл. и изкл.}
    $\{(X,Y) \mid X,Y\subseteq U\ \&\ |(X\setminus Y)\cup(Y\setminus X)| = 1\ \&\ X\cap Y = \emptyset\ \&\ |X|\geq 2\ \&\ |Y|\geq 3\}$;
  \item
    \marginpar{Отг. $8^n$}
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\}$;
  \item
    \marginpar{Отг. $6^n$}
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X \cap Y = \emptyset\}$;
  \item
    \marginpar{$U = X\overline{Y}Z\cup X\overline{YZ} \cup \overline{X}Y\overline{Z}$. Отг. $3^n$}
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X\cup Y\overline{Z} = \overline{X}\cup\overline{Y}\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ Y\cup X = Z\cup\overline{Y}\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X\cup Y\overline{Z} = \overline{X}\cup\overline{Y}\ \&\ |Z| = 0\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z \subseteq U\ \&\ X\cup Y\overline{Z} = \overline{X}\cup\overline{Y}\ \&\ |X|\geq 1\ \&\ |Y|\geq 1\ \&\ |Z| = 1\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X\cup Y\overline{Z} = \overline{X}\cup\overline{Y}\ \&\ |X|\geq 1\ \&\ |Y|\geq 1\ \&\ |Z|\leq 1\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X \cup YZ = \ov{X} \cup \ov{Z}\}$;
  \item
    $\{(X,Y,Z) \mid X,Y,Z\subseteq U\ \&\ X\ov{Y} \cup YZ = U\}$;
  \end{enumerate}
\end{problem}
\begin{hint}
  \begin{enumerate}[a)]
  \item
    Понеже всички подмножества на $U$ са $2^n$ и множествата $X$ и $Y$ са независими едно от друго, то
    лесно се съобразява, че броят на елементите на $\{(X,Y) \mid X,Y \in U\} = \Ps(U) \times \Ps(U)$ е $4^n$.
    Ще дадем и друго доказателство, което ще ни помогне да решаваме по-сложни задачи, в които имаме връзка между 
    елементите на $X$ и $Y$.
    
    Нека $U = \{u_1,\dots,u_n\}$ и да разгледаме азбуката $\Sigma = \{XY, X\bar{Y}, \bar{X}Y, \bar{X}\bar{Y}\}$.
    На всеки елемент на  $\{(X,Y) \mid X,Y \subseteq U\}$ можем еднозначно да съпоставим 
    дума  $\alpha = a_1\cdots a_n$ над азбуката $\Sigma$
    по следния начин:
    \marginpar{Всеки елемент $u_i \in U$ попада в един от четирите случаи}
    \begin{itemize}
    \item 
      ако $u_i \in X \cap Y$, то $a_i = XY$;
    \item 
      ако $u_i \in X \cap \bar{Y}$, то $a_i = X\bar{Y}$;
    \item 
      ако $u_i \in \bar{X} \cap Y$, то $a_i = \bar{X}Y$;
    \item 
      ако $u_i \in \bar{X} \cap \bar{Y}$, то $a_i = \bar{X}\bar{Y}$.
    \end{itemize}
    Да разгледаме няколко примера:
    \begin{itemize}
    \item
      на двойката $(\{u_1\},\{u_2\})$ съпоставяме думата $\alpha = a_1\cdots a_n$,
      където $a_1 = X\bar{Y}$, $a_2 = \bar{X}Y$, $a_i = \bar{X}\bar{Y}$ за $i \geq 3$.
    \item 
      на двойката $(U,\{u_2\})$ съпоставяме думата $\alpha = a_1\cdots a_n$,
      където $a_2 = XY$ и $a_i = X\bar{Y}$ за $i \neq 2$.
    \item
      на двойката $(\{u_1\},\{u_1,u_2\})$ съпоставяме думата $\alpha = a_1\cdots a_n$,
      където $a_1 = XY$ и $a_2 = \bar{X}Y$, $a_i = \bar{X}\bar{Y}$ за $i \geq 3$.
    \end{itemize}
    Понеже всички думи с дължина $n$ над азбука с $4$ букви са $4^n$, 
    то всички двойки $(X,Y)$ са също $4^n$.
  \item
    Трябва да намерим всичи думи с дължина $n$ над азбуката $\{XY,X\ov{Y},\ov{X}Y,\ov{X}\ov{Y}\}$,
    като буквите $XY$ и $X\ov{Y}$ се срещат общо веднъж.
    Това означава, че от $n$ позиции трябва да изберем една, в която да поставим $XY$ или $X\ov{Y}$,
    а в останалите $n-1$ позиции поставяме буквите $\ov{X}Y$ или $\ov{X}\ov{Y}$.
    Така получаваме като резултат \[2\binom{n}{1}2^{n-1} = n2^n.\]
  \item
    Тук разглеждаме тези думи с дължина $n$ над азбуката $\Sigma$, като
    има {\em точно едно} срещане на $XY$ или $X\ov{Y}$.
    Всички тези думи са $2\binom{n}{1}2^{n-1}$
  \item[ф)]
    Понеже $X \cap Y = \emptyset$, то в думите не се срещат буквите $XYZ$ и $XY\ov{Z}$.
    Така остават $6$ възможни букви и оттук веднага следва, че всички такива думи са $6^n$.    
  \item[х)]
    Да разгледаме какво означава $X\cup Y\ov{Z} = \ov{X} \cup \ov{Y}$.
    \begin{itemize}
    \item 
      Ако $x \in X$, то $x \in X \cup Y\ov{Z}$ и следователно $x \in \ov{X} \cup \ov{Y}$.
      Тогава е ясно, че $x \in \ov{Y}$. Това означава, че имаме буквите $X\ov{Y}Z$ и $X\ov{Y}\ov{Z}$.
    \item
      Ако $x \in \ov{X}$, то $X \in \ov{X} \cup \ov{Y}$ и следователно $x \in X \cup Y\ov{Z}$.
      Сега получаваме, че $x \in Y\ov{Z}$. Това означава, че имаме буквата $\ov{X}Y\ov{Z}$.
    \end{itemize}
    Видяхме, че с горното ограничение трябва да разгледаме само думите с дължина $n$ съставени от три букви.
    Те са общо $3^n$ на брой.
  \end{enumerate}
\end{hint}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "discrete-math"
%%% End: 
