\chapter{Езици и автомати}

\section{Автоматни езици}

Един от източниците е втора и трета глава от книгата на Сипсер, \cite{sipser}.
Друг основен източник е книгата на Пападимитриу и Люис, \cite{papadimitriou}.
%По Сипсер, стр. 35
\begin{dfn}
  Краен автомат е петорка $\A = \FA$, където
  \begin{enumerate}[1)]
  \item
    $Q$ е крайно множество, наречено състояния;
  \item
    $\Sigma$ е крайно множество, наречено азбука;
  \item
    \marginpar{Тук нямаме $\varepsilon$-преходи}
    $\delta:Q\times\Sigma\to Q$ е (частична) функция на преходите;
  \item
    $s\in Q$ е начално състояние;
  \item
    $F\subseteq Q$ е множеството от финални състояния.
  \end{enumerate}
\end{dfn}

Нека имаме една дума $\alpha \in \Sigma^\star$, $\alpha = a_1a_2\cdots a_n$.
Казваме, че $\alpha$ се {\bf разпознава} от автомата $\A$, ако
съществува редица от състояния $q_0,q_1,q_2,\dots,q_n$, такива че:
\begin{enumerate}[1)]
\item 
  $q_0 = s$;
\item
  $\delta(q_i,a_{i+1}) = q_{i+1}$, за всяко $i < n$;
\item
  $q_n \in F$.
\end{enumerate}

Казваме, че $\A$ {\bf разпознава} езика $L$, ако $\A$ разпознава точно думите от $L$, т.е.
$L = \{\alpha \in \Sigma^\star \mid \A\mbox{ разпознава }\alpha\}$.
Обикновено означаваме езика, който се разпознава от даден автомат $\A$ с $L(\A)$.

\begin{dfn}
  \index{език!автоматен}
  Един език $L$ се нарича автоматен, ако съществува автомат $\A$, който разпознава $L$, т.е.
  \[L = L(\A).\]
\end{dfn}

Удобно е да разгледаме транзитивното затваряне на $\delta$:
\begin{enumerate}
\item 
  $\delta^\star(q,\varepsilon) = q$;
\item
  $\delta^\star(q,a\alpha) = \delta^\star(\delta(q,a),\alpha)$;
\end{enumerate}
Тогава \[L(\A) = \{\alpha\in\Sigma^\star \mid \delta^\star(s,\alpha) \in F\}.\]

\begin{prop}
  \[(\forall q\in Q)(\forall\alpha,\beta\in\Sigma^\star)[\delta^\star(q,\alpha\beta) = \delta^\star(\delta^\star(q,\alpha),\beta)].\]
\end{prop}
\begin{proof}
  Индукция по дължината на $\alpha$.
\end{proof}

\begin{thm}
  Класът на автоматните езици е затворен относно операцията обединение.
  Това означава, че ако $L_1$ и $L_2$ са два произволни автоматни езика над азбуката $\Sigma$, то $L_1\cup L_2$
  също е автоматен език.
\end{thm}
\begin{proof}
  Нека $L_1 = L(\A_1)$ и $L_2 = L(\A_2)$, 
  където $\A_1 = \FAn{1}$ и $\A_2 = \FAn{2}$ са тотални.
  Определяме автомата $\A = \FA$, който разпознава $L_1\cup L_2$.
  \begin{enumerate}[1)]
  \item
    $Q = Q_1\times Q_2$;
  % \item
  %   $\Sigma = \Sigma_1\cup \Sigma_2$;
  \item
    Определяме за всяко $\pair{r_1,r_2} \in Q$ и всяко $a \in \Sigma$,
    \[\delta(\pair{r_1,r_2},a) = \pair{\delta_1(r_1,a),\delta_2(r_2,a)};\]
  \item
    $s_0 = \pair{s_1,s_2}$;
  \item
    $F = \{\pair{r_1,r_2}\mid r_1\in F_1\vee r_2 \in F_2\} = (F_1\times Q_2)\cup (Q_1\times F_2)$.
  \end{enumerate}
  Проверете, че $L(\A) = L(\A_1)\cup L(\A_2)$.
\end{proof}

\begin{cor}
  Класът на автоматните езици е затворен относно операцията сечение.
  Това означава, че ако $L_1$ и $L_2$ са два произволни автоматни езика над азбуката $\Sigma$, то $L_1\cap L_2$
  също е автоматен език.
\end{cor}
\begin{proof}
  Същата конструкция на автомата $\A = \FA$, 
  с единствената разлика, че тук 
  \[F = \{\pair{q_1,q_2} \mid q_1 \in F_1\ \&\ q_2 \in F_2\} = F_1\times F_2.\]
\end{proof}

\begin{lemma}
  Нека $L$ е автоматен език.
  Тогава $\Sigma^\star\setminus L$ също е автоматен език.
\end{lemma}
\begin{proof}
  Нека $L = L(\A)$, където $\A$ е тотален.
  Тогава $\Sigma^\star\setminus L = L(\A^\prime)$,
  където $\A^\prime$ е същия като $\A$, само $F^\prime = Q\setminus F$.
\end{proof}


\begin{prb}
  Докажете, че езикът $L$ е автоматен.
  \begin{enumerate}[a)]
  \item 
    $L = \{a^nb\mid n \geq 0\}$;
  \item
    $L = \{a^nb\mid n \geq 1\}$;
  \item
    $L = \{a^nb^m\mid n,m \geq 0\}$;
  \item
    $L = \{a^nb^m\mid n,m \geq 1\}$;
  \item
    $L = \{a^nb^mc^k\mid n,m,k \geq 1\}$;
  \item
    $L = \{a,b\}^\star \setminus \{a\}$;
  \item
    $L = \{w \in \{a,b\}^\star\mid \abs{w} \leq 3\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ започва с }ab\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ завършва с }ab\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ съдържа }bab\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ не съдържа }bab\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ няма две последователни }a\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w \mbox{ съдържа точно едно }a\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid \mbox{ всяко }a\mbox{ в }w\mbox{ се следва от поне едно }b\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid \abs{w} \equiv 0 \mod 3\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid N_a(w) \equiv 0 \mod 3\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid N_b(w) \equiv 1 \mod 2\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid N_a(w) \equiv 0 \mod 3\ \&\ N_b(w) \equiv 1 \mod 2\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid w\mbox{ започва и завършва с една и съща буква}\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid N_a(w) \equiv 0 \mod 2\ \&\ N_b(w) \equiv 1 \mod 2\}$;
  \item
    $L = \{w \in \{a,b\}^\star \mid N_a(w) \equiv 0 \mod 2\ \vee\ w \mbox{ съдържа точно две }b\}$;
  \end{enumerate}
\end{prb}

В повечето от горните задачи е на практика очевидно да се съобрази, че построения автомат разпознава дадения език.
При по-сложни задачи обаче, ще се наложи да дадем доказателство.
Ще дадем няколко такива примера.

\begin{prb}
  Докажете, че езикът
  \[L = \{\alpha \in \{a,b\}^\star\ \mid\ \alpha\mbox{ не съдържа две поредни срещания на }a\}\]
  е автоматен.
\end{prb}
\begin{proof}
  Ето картинка на автомата $\A = \FA$:
  \begin{figure}[h!]
    \begin{subfigure}[b]{0.3\textwidth}% [$L_1 = L(M_1)$]{
      \begin{tikzpicture}[->,>=stealth,thick,node distance=45pt]
        \tikzstyle{every state}=[circle,minimum size=15pt,auto]
        
        \node[initial, accepting, state] (0) {$s$};
        \node[accepting, state]   (1) [right of=0]{$q_1$};
        \node[state]   (2) [right of=1]{$q_2$};
        
        \path 
        (0) edge [loop above]   node [above] {$b$}   (0)
        (0) edge [bend left=15] node [above] {$a$}   (1)
        (1) edge [bend left=15] node [below] {$b$}   (0)
        (1) edge [bend left=15] node [above] {$a$}   (2)
        (2) edge [loop above]   node [above] {$a,b$} (2);
      \end{tikzpicture}
    \end{subfigure}
 \end{figure}

 Трябва да докажем, че наистина $L = L(\A)$.
 Първо ще се концентрираме върху доказателството на $L(\A) \subseteq L$.
 Ще докажем с индукция по дължината на думата $\alpha$, че:
 \begin{enumerate}[(1)]
 \item 
   ако $\delta^\star(s,\alpha) = s$, то
   $\alpha$ не съдържа две поредни срещания на $a$
   и завършва на $b$;
 \item
   ако $\delta^\star(s,\alpha) = q_1$, то
   $\alpha$ не съдържа две поредни срещания на $a$
   и завършва на $a$.
 \end{enumerate}

 За $\abs{\alpha} = 0$, то твърдението е ясно (Защо?).
 
 Нека $\abs{\alpha} = n+1$, т.е. $\alpha = \beta x$, където $\abs{\beta} = n$.
 \begin{enumerate}[(i)]
 \item 
   Нека $\delta^\star(s,\beta x) = s = \delta(\delta^\star(s,\beta),x)$.
   Според дефиницията на $\delta$, $x = b$ и $\delta^\star(s,\beta) \in F$.
   Тогава по {\bf И.П.} за (1), $\beta$ не съдържа две поредни срещания на $a$.
   Тогава е очевидно, че $\beta b$ не  съдържа две поредни срещания на $a$.
 \item
   Нека $\delta^\star(s,\beta x) = q_1 = \delta(\delta^\star(s,\beta),x)$.
   Според дефиницията на $\delta$, $x = a$ и $\delta^\star(s,\beta) = s$.
   Тогава по {\bf И.П.} за (2), $\beta$ не съдържа две поредни срещания на $a$
   и завършва на $b$.
   Тогава е очевидно, че $\beta a$ не съдържа две поредни срещания на $a$.
 \end{enumerate}
 
 Така доказахме, че $L(\A) \subseteq L$.

 Сега ще докажем другата посока, т.е. $L \subseteq L(\A)$.
 Това означава да докажем, че
 \[(\forall \alpha \in \Sigma^\star)[\alpha \in L\ \Rightarrow\ \delta^\star(s,\alpha) \in F],\]
 което е еквивалентно на
 \[(\forall \alpha \in \Sigma^\star)[\delta^\star(s,\alpha) \not\in F\ \Rightarrow\ \alpha\not\in L].\]
 Ще докажем това твърдение отново с индукция по дължината на $\alpha$.
 Нека $\abs{\alpha} = 0$. Тогава твърдението е очевидно. (Защо?)
 Нека $\abs{\alpha} = n+1$. В този случай 
 да обърнем внимание, че щом $\delta^\star(s,\alpha) \not\in F$, то
 $\delta^\star(s,\alpha) = q_2$ и думата $\alpha$ може да се разбие по следния начин:
 \[\alpha = \beta a \gamma\ \&\ \delta^\star(s,\beta) = q_1.\]
 
 Сега по свойство (2) от по-горе, че щом $\delta^\star(s,\beta) = q_1$, то
 $\beta$ не съдържа две поредни срещания на $a$, но завършва на $a$.
 Сега е очевидно, че $\beta a$ съдържа две поредни срещания на $a$ и 
 щом $\beta a$ е префикс на $\alpha$, то думата $\alpha \not\in L$.
 С това доказахме и посоката $L\subseteq L(\A)$.
\end{proof}



\begin{framed}
  За една дума $\alpha \in \{0,1\}^\star$, 
  нека с $\alpha_{(2)}$ да означим числото в десетична бройна система, което се представя в двоична бройна система като $\alpha$.
  Например, $1101_{(2)} = 1 \cdot 2^3+1\cdot 2^2+0\cdot 2^1+1\cdot 2^0 = 13$.
  Тогава имаме следните свойства:
  \begin{itemize}
  \item
    $\varepsilon_{(2)} = 0$,
  \item
    $(\alpha0)_{(2)} = 2\cdot(\alpha)_{(2)}$,
  \item
    $(\alpha1)_{(2)} = 2\cdot(\alpha)_{(2)} + 1$.
  \end{itemize}
\end{framed}

\begin{prb}
  Докажете, че езикът
  $L = \{w \in \{0,1\}^\star \mid w_{(2)} \equiv 1 \mod 3\}$
  е автоматен.
\end{prb}
\begin{proof}
  Нашият автомат ще има три състояния $\{q_0,q_1,q_2\}$, като началното състояние ще бъде $q_0$.
  Нашата цел е да дефинираме така автомата, че да имаме следното свойство:
  \[(\forall\alpha\in\Sigma^\star)(\forall i < 3)[\alpha_{(2)} \equiv i\mod 3\ \Leftrightarrow\ \delta^\star(q_0,\alpha) = q_i].\]
  Понеже искаме нашия автомат да разпознава тези думи $\alpha$,
  за които $\alpha_{(2)} \equiv 2\mod 3$, финалното състояние ще бъде $q_2$.
  Дефинираме функцията $\delta$ следвайки следните свойства:
  \begin{enumerate}[(1)]
  \item
    $\alpha_{(2)} \equiv 0 \mod 3\ \Rightarrow\ (\alpha0)_{(2)} \equiv 0 \mod 3$; тогава $\delta(q_0,0) = q_0$.
  \item 
    $\alpha_{(2)} \equiv 0 \mod 3\ \Rightarrow\ (\alpha1)_{(2)} \equiv 1 \mod 3$; тогава $\delta(q_0,1) = q_1$.
  \item
    $\alpha_{(2)} \equiv 1 \mod 3\ \Rightarrow\ (\alpha0)_{(2)} \equiv 2 \mod 3$; тогава $\delta(q_1,0) = q_2$.
  \item 
    $\alpha_{(2)} \equiv 1 \mod 3\ \Rightarrow\ (\alpha1)_{(2)} \equiv 0 \mod 3$; тогава $\delta(q_1,1) = q_0$.
  \item
    $\alpha_{(2)} \equiv 2 \mod 3\ \Rightarrow\ (\alpha0)_{(2)} \equiv 1 \mod 3$; тогава $\delta(q_2,0) = q_1$.
  \item 
    $\alpha_{(2)} \equiv 1 \mod 3\ \Rightarrow\ (\alpha1)_{(2)} \equiv 2 \mod 3$; тогава $\delta(q_2,1) = q_2$.
  \end{enumerate}
  
  Ето и картинка на автомата:
  \begin{figure}[h!]
    \begin{subfigure}[b]{0.3\textwidth}% [$L_1 = L(M_1)$]{
      \begin{tikzpicture}[->,>=stealth,thick,node distance=45pt]
        \tikzstyle{every state}=[circle,minimum size=15pt,auto]
        
        \node[initial,state] (0) {$q_0$};
        \node[state]   (1) [right of=0]{$q_1$};
        \node[accepting, state]   (2) [below of=1]{$q_2$};
        
        \path 
        (0) edge [loop above]  node [above] {$0$} (0)
        (0) edge [bend left=15] node [above] {$1$} (1)
        (1) edge [bend right=15] node [left] {$0$} (2)
        (1) edge  [bend left=15] node [below] {$1$} (0)
        (2) edge  [bend right=15] node [right] {$0$} (1)
        (2) edge [loop right] node [right] {$1$} (2);
      \end{tikzpicture}
    \end{subfigure}
 \end{figure}


  Ще докажем едновременно с индукция по дължината на думата $\alpha$, че
  \begin{enumerate}[(1)]
  \item 
    $\delta^\star(q_0,\alpha) = q_0\ \Rightarrow\ \alpha_{(2)} \equiv 0 \mod 3$,
  \item 
    $\delta^\star(q_0,\alpha) = q_1\ \Rightarrow\ \alpha_{(2)} \equiv 1 \mod 3$,
  \item 
    $\delta^\star(q_0,\alpha) = q_2\ \Rightarrow\ \alpha_{(2)} \equiv 2 \mod 3$,
  \end{enumerate}
  
  За $\abs{\alpha} = 0$, всички условия са изпълнени. (Защо?)
  
  Нека $\abs{\alpha} = n+1$, т.е. $\alpha = \beta x$, $\abs{\beta} = n$.
  За да приложим индукционното предположение, ще използваме следното свойство:
  \[\delta^\star(q_0,\beta x) = \delta(\delta^\star(q_0,\beta),x).\]
  
  Ще докажем подробно само (3).
  Нека $\delta^\star(q_0,\beta x) = q_2$. 
  Имаме два случая:
  \begin{itemize}
  \item 
    $x = 0$. 
    Тогава, по дефиницията на $\delta$, 
    $\delta(q_1,0) = q_2$ и следователно, $\delta^\star(q_0,\beta) = q_1$.
    По {\bf И.П.} за (2) с $\beta$,
    \[\delta^\star(q_0,\beta) = q_1\ \Rightarrow\ \beta_{(2)} \equiv 1 \mod 3\]
    Тогава, $(\beta0)_{(2)} \equiv 2 \mod 3$. Така доказахме, че
    \[\delta^\star(q_0,\beta 0) = q_2\ \Rightarrow\ (\beta 0)_{(2)} \equiv 2 \mod 3.\]
  \item
    $x = 1$.
    Тогава, по дефиницията на $\delta$, $\delta(q_2,1) = q_2$ и следователно,
    $\delta^\star(q_0,\beta) = q_2$.
    По {\bf И.П.} за (3) с $\beta$,
    \[\delta^\star(q_0,\beta) = q_2\ \Rightarrow\ \beta_{(2)} \equiv 2 \mod 3.\]
    Тогава, $(\beta1)_{(2)} \equiv 2 \mod 3$. Така доказахме, че
    \[\delta^\star(q_0,\beta 1) = q_2\ \Rightarrow\ (\beta 1)_{(2)} \equiv 2 \mod 3.\]
  \end{itemize}
  
  За да докажем (1), нека $\delta^\star(q_0,\beta x) = q_0$. 
  \begin{itemize}
  \item 
    $x = 0$. Разсъжденията са аналогични, като използваме {\bf И.П.} за (1).
  \item
    $x = 1$. Разсъжденията са аналогични, като използваме {\bf И.П.} за (2).
  \end{itemize}
  
  По същия начин доказваме и (2). Нека $\delta^\star(q_0,\beta x) = q_1$. 
  \begin{itemize}
  \item 
    При $x = 0$, използваме {\bf И.П.} за (3).
  \item
    При $x = 1$, използваме {\bf И.П.} за (1).
  \end{itemize}

  От (1), (2) и (3) следва, че също така имаме $L = L(\A)$. (Защо?)
\end{proof}


\section{Регулярни езици}

\begin{dfn}
  \index{регулярен език}
  \index{регулярен израз}
  \marginpar{Това е пример за индуктивна дефиниция.}
  Нека е дадена азбука $\Sigma$. Дефинираме множеството от
  {\em регулярни езици} над азбуката $\Sigma$ и едновременно с това 
  множеството от {\em регулярни изрази}, които разпознават тези езици.
  \begin{enumerate}[1)]
  \item
   за всеки символ $a \in \Sigma$, $\{a\}$ е регулярен език,
   който се разпознава от регулярния израз $a$;
  \item
    $\{\varepsilon\}$ е регулярен език,
    който се разпознава от регулярния израз $\varepsilon$;
  \item
    $\emptyset$ е регулярен език,
    който се разпознава от регулярния израз $\emptyset$;
  \item
    $L_1\cup L_2$, където $L_1$ и $L_2$ са регулярни езици,
    който се разпознава от регулярния израз $(r_1\vert r_2)$,
    където $r_1$ и $r_2$ са регулярните изрази за $L_1$ и $L_2$;
  \item
    \marginpar{Конкатенация. Обикновено изпускаме $\cdot$}
    $L_1\cdot L_2 = \{uw\mid u \in L_1\ \&\ w \in L_2\}$, където $L_1$ и $L_2$ са регулярни езици,
    който се разпознава от регулярния израз $(r_1\cdot r_2)$,
    където $r_1$ и $r_2$ са регулярните изрази за $L_1$ и $L_2$;
  \item
    \marginpar{Звезда на Клини}
    $L^\star = \{w_1w_2\cdots w_n\mid n \in \Nat\ \&\ w_i \in L\mbox{ за всяко } i \leq n\}$,  където $L$ е регулярен език,
    който се разпознава от регулярния израз $(r^\star)$,
    където $r$ е регулярния израз за $L$.
  \end{enumerate}
\end{dfn}

\begin{example}
  Нека да разгледаме няколко примера какво точно представлява прилагането
  на операцията звезда на Клини върху един език.
  \begin{itemize}
  \item
    Можем да запишем, че $L^\star = \bigcup_n L^n$, където
    $L^0 = \{\varepsilon\}$ и $L^{n+1} = L^n\cdot L$.    
  \item 
    Нека $L = \{0,11\}$. 
    Тогава $L^0 = \{\varepsilon\}$, $L^1 = L$,
    $L^2 = L^1\cdot L^1 = \{00,011,110,1111\}$,
    $L^3 = L^1\cdot L^2 = \{000,0011,0110,01111,1100,11011,11110,111111\}$.
  \item
    Нека $L = \emptyset$.
    Тогава $L^0 = \{\varepsilon\}$, $L^1 = \emptyset$, $L^2 = L^1 \cdot L^1 = \emptyset$.
    Получаваме, че $L^\star = \{\varepsilon\}$, т.е. {\em краен} език
  \item
    Нека $L = \{0^i\mid i \in \N\} = \{\varepsilon, 0, 00, 000, \dots\}$.
    Тогава лесно може да се види, че $L = L^\star$.
  \item
    Също така, обърнете внимание, че за произволен език $L$,
    $(L^\star)^\star = L^\star$.
  \end{itemize}
\end{example}

\begin{lemma}
  Ако един език е автоматен, то той се описва с регулярен израз.
\end{lemma}
\begin{proof}% [\cite{papadimitriou}, стр. 79]
  \marginpar{От \cite{papadimitriou}, стр. 79}
  Нека  $L = L(M)$, за някой автомат $M$.
  Да фиксираме едно изброяване на състоянията $Q = \{q_1,\dots,q_n\}$,
  като началното състояние е $q_1$.
  Ще означаваме с $L(i,j,k)$ множеството от тези думи, които
  могат да се разпознаят от автомата по път, който започва от $q_i$,
  завършва в $q_j$, и междинните състояния имат индекси $\leq k$.
  Тогава за $n = \abs{Q}$, 
  \[L(i,j,n) = \{w\in\Sigma^\star\mid q_j\in \Delta^\star(q_i, w)\}.\]
  Следователно,
  \[L(M) = \bigcup\{L(1,j,n)\mid q_j \in F\}.\]
  Ще докажем с индукция по $k$, че за всяко $i,j,k$, множествата от думи $L(i,j,k)$
  се описват с регулярен израз.
  \begin{enumerate}[a)]
  \item
    Нека $k = 0$. Ще докажем, че за всяко $i,j$, $L(i,j,0)$ се описва с регулярен израз.
    Имаме да разгледаме два случая.
    
    Ако $i = j$, то 
    \[L(i, j, 0) = \{\varepsilon\}\cup\{a\in\Sigma_\varepsilon\mid (q_i, a, q_j) \in \Delta\}.\]
    Ако $i \neq j$, то
    \[L(i, j, 0) = \{a\in\Sigma_\varepsilon\mid (q_i, a, q_j) \in \Delta\}.\]
  \item
    Да предположим, че $k > 0$ и за всяко $i,j$, можем да намерим регулярните изрази
    съответстващи на $L(i,j,k-1)$. Тогава
    \[L(i,j,k) = L(i,j,k-1)\ \cup\ L(i,k,k-1)\cdot (L(k,k,k-1)^\star) \cdot L(k,j,k-1).\]
    Тогава по и.п. следва, че $L(i,j,k)$ може да се опише с регулярен израз.
  \end{enumerate}
  Заключаваме, че за всяко $i,j,k$, $L(i,j,k)$ може да се опише с регулярен израз.
\end{proof}

\begin{example}
  Да разгледаме следния автомат:
  
  \begin{figure}[h!]
    \begin{subfigure}[b]{0.3\textwidth}
      \label{subf:a1}
      \begin{tikzpicture}[->,>=stealth,thick,node distance=45pt]
        \tikzstyle{every state}=[circle,minimum size=15pt,auto]
        
        \node[initial,state] (1) {$1$};
        \node[accepting, state]   (2) [right of=1]{$2$};
        
        \path 
        (1) edge [loop above]  node [above] {$1$} (1)
        (1) edge  node [above] {$0$} (2)
        (2) edge [loop above] node [above] {$0,1$} (2);
      \end{tikzpicture}
      \caption{$L_1 = L(A_1)$}
    \end{subfigure}
 \end{figure}

Нека $R(i,j,k)$ да бъде регулярният израз, който описва езика $L(i,j,k)$.
Това означава, че за да намерим регулярния език за автомата от Фигура \ref{subf:a1}, 
трабва да намерим $R(1,2,2)$, защото началното състояние е $1$, финалното е $2$ и 
броят на състоянията в автомате е $2$.
За упражнение, само за този пример ще намерим всички възможни $R(i,j,k)$.
\begin{itemize}
\item 
  За $k = 0$ имаме:
  
  $R(1,1,0) = \varepsilon\vert 1$, $R(1,2,0) = 0$, $R(2,1,0) = \emptyset$, $R(2,2,0) = \varepsilon\vert 0 \vert 1$,
\item
  За $k = 1$ имаме:
  \begin{align*}
    R(1,1,1) =\ & R(1,1,0)\ \vert\ R(1,1,0) R(1,1,0)^\star R(1,1,0) \\
    =\ &\varepsilon\ \vert\ 1\ \vert\ (\varepsilon \vert 1)(\varepsilon\vert 1)^\star(\varepsilon \vert 1)\\
    =\ & 1^\star,\\
    R(1,2,1) =\ & R(1,2,0)\ \vert\ R(1,1,0) R(1,1,0)^\star R(1,2,0)\\
    =\ & 0\ \vert\ (\varepsilon \vert 1)(\varepsilon \vert 1)^\star0\\
    =\ & 1^\star0,\\
    R(2,1,1) =\ & R(2,1,0)\ \vert\ R(2,1,0)R(1,1,0)^\star R(1,1,0) \\
    =\ & \emptyset\ \vert\ \emptyset (\varepsilon\vert 1)^\star(\varepsilon \vert 1) = \emptyset,\\
    R(2,2,1) =\ & R(2,2,0)\ \vert\ R(2,1,0)R(1,1,0)^\star R(1,2,0)\\
    =\ & \varepsilon\vert 0 \vert 1\vert\ \emptyset(\varepsilon \vert 1)^\star0\\
    =\ &  \varepsilon\vert 0 \vert 1
  \end{align*}
    
\item
  За $k = 2$ имаме:
  \begin{align*}
    R(1,1,2) =\ & R(1,1,1)\ \vert\ R(1,2,1)R(2,2,1)^\star R(2,1,1) \\
    =\ & 1^\star\ \vert\ 1^\star0(\varepsilon\vert 0 \vert 1)^\star \emptyset \\
    =\ & 1^\star,\\
    R(1,2,2) =\ & R(1,2,1)\ \vert\ R(1,2,1)R(2,2,1)^\star R(2,2,1) \\
    =\ & 1^\star0\ \vert\ 1^\star0 (\varepsilon \vert 0 \vert 1)^\star (\varepsilon \vert 0 \vert 1) \\
    =\ & 1^\star 0 (0\vert 1)^\star,\\
    R(2,1,2) =\ & R(2,1,1)\ \vert\ R(2,2,1)R(2,2,1)^\star R(2,1,1) \\
    =\ & \emptyset\ \vert\ (\varepsilon\vert 0 \vert 1)(\varepsilon \vert 0 \vert 1)^\star \emptyset \\
    =\ & \emptyset,\\
    R(2,2,2) =\ & R(2,2,1)\ \vert\ R(2,2,1)R(2,2,1)^\star R(2,2,1) \\
    =\ & (\varepsilon\vert 0 \vert 1)\ \vert\ (\varepsilon\vert 0 \vert 1)(\varepsilon\vert 0 \vert 1)^\star(\varepsilon\vert 0 \vert 1)\\
    =\ & (0\vert 1)^\star.
  \end{align*}
\end{itemize}
Ясно е, че $L_1$ се описва с регулярния израз $R(1,2,2) = 1^\star 0 (0\vert 1)^\star$.
\end{example}

\section{Допълнителни свойства}

Някои свойства на регулярните езици:
\begin{itemize}
\item 
  те са затворени относно хомоморфизми, т.е.
  ако $L \subseteq \Sigma^\star_1$ е регулярен език и $h:\Sigma_1\to\Sigma^\star_2$ е хомоморфизъм, 
  то езикът $h(L) = \{h(\alpha) \in \Sigma^\star_2 \mid \alpha \in L\}$
  е регулярен.
\item
  те са затворени относно обратни хомоморфизми, т.е.
  ако $L\subseteq \Sigma^\star_2$ е регулярен език и $h:\Sigma_1\to\Sigma^\star_2$ е хомоморфизъм, 
  то езикът $h^{-1}(L) = \{\alpha \in \Sigma^\star_1 \mid h(\alpha) \in L\}$
  е регулярен.
\end{itemize}

\section{Езици, които не са регулярни}
\begin{lemma}[за разрастването (регулярни езици)]
  % \index{лема за разрастването!регулярни езици}
  % \label{lem:pumping-reg}
  % \marginpar{На англ.\\ Pumping Lemma}
  Нека $\Ls$ да бъде безкраен регулярен език.
  Съществува число $n\geq 1$, зависещо само от $\Ls$, 
  за което за всяка дума $\alpha\in \Ls, \abs{\alpha}\geq n$ може да 
  бъде записана във вида $\alpha = xyz$ и 
  \begin{enumerate}
  \item
    $|y|\geq 1$;
  \item
    $|xy|\leq n$;
  \item
    % \marginpar{$i = 0\ \rightarrow\ xz \in \Ls$}
    $(\forall i\in\N)[xy^iz \in \Ls]$.
  \end{enumerate}
\end{lemma}

\begin{crl}
  Регулярният език $\Ls$, 
  разпознаван от КДА $M$ е непразен тoчно тогава, когато съдържа дума $\alpha, \abs{\alpha} \leq \abs{Q}$.
\end{crl}

\begin{problem}
  \marginpar{$c^+\{a^nb^n\mid n\in\N\}\cup (a\vert b)^\star$}
  Да се даде пример за език $L$, който {\bf не} е регулярен, но удовлетворява
  лемата за разрастването.
\end{problem}


% \section{Регулярни езици}
% \begin{problem}
%   Нека $\Sigma = \{0,1\}$.  Проверете дали $L$ е регулярен, където
%   \begin{enumerate}[1)]
%   \item
%     $L_1 = \{0^i1^i\ \mid\ i\geq 0\}$;
%   \item
%     $L_2 = \{0^i1^j\ \mid\ i > j\}$;
%   \item
%     $L_3 = \{0^{2n}\ \mid\ i\geq 1\}$;
%   \item
%     $L_4 = \{0^1m1^n0^{m+n}\ \mid\ m\geq 1\ \&\ n\geq 1\}$;
%   \item
%     $L_5 = \{0^n\ \mid\ n\mbox{ е просто }\}$;
%   \item
%     $L_6 = \{w\mid w\in\{0,1\}^\star\mbox{ има равен брой нули и единици}\}$;
%   \item
%     $L_7 = \{ww\mid w\in\{0,1\}^\star\}$;
%   \item
%     $L_8 = \{1^{n^2}\mid n\geq 0\}$;
%   \item
%     $L_{9} = \{0^n1^n2^n\mid n\geq 0\}$;
%   \item
%     $L_{10} = \{www\mid w\in \{0,1\}^\star\}$;
%   \item
%     $L_{11} = \{0^{2^n}\mid n\geq 0\}$;
%   \item
%     $L_{12} = \{0^m1^n\mid n\neq m\}$;
%   \end{enumerate}
% \end{problem}

\begin{problem}
  Нека $\Sigma = \{a,b\}$.  Проверете дали $L$ е регулярен, където
  \begin{enumerate}[1)]
  \item
    $L = \{\alpha^R \mid \alpha \in L_0\}$, където $L_0$ е регулярен;
  \item
    $L_1 = \{a^ib^i\ \mid\ i\geq 0\}$;
  \item
    $L_2 = \{a^ib^j\ \mid\ i > j\}$;
  \item
    $L_3 = \{a^{2n}\ \mid\ n\geq 1\}$;
  \item
    $L_4 = \{a^mb^na^{m+n}\ \mid\ m\geq 1\ \&\ n\geq 1\}$;
  \item
    $L_5 = \{a^n\ \mid\ n\mbox{ е просто число}\}$;
  \item
    $L = \{a^{n.m}\mid n,m\mbox{ са прости числа}\}$;
  \item
    $L_6 = \{w\mid w\in\{a,b\}^\star\mbox{ има равен брой нули и единици}\}$;
  \item
    $L_7 = \{ww\mid w\in\{a,b\}^\star\}$;
  \item
    $L_8 = \{ww^R\mid w\in\{a,b\}^\star\}$;
  \item
    $L_9= \{a^{n^2}\mid n\geq 0\}$;
  \item
    $L_{10} = \{a^nb^nc^n\mid n\geq 0\}$;
  \item
    $L_{11} = \{www\mid w\in \Sigma^\star\}$;
  \item
    $L_{12} = \{a^{2^n}\mid n\geq 0\}$;
  \item
    $L_{13} = \{a^mb^n\mid n\neq m\}$;
  \item
    $L_{14} = \{a^{n!}b^{n!}\mid n\neq 1\}$;
  \item
    $L_{15} = \{a^{f_n} \mid f_0 = f_1 = 1\ \&\ f_{n+2} = f_{n+1} + f_{n}\}$;
  \item
    $L = \{\alpha \in \{a,b\}^\star \mid \abs{n_a(\alpha) - n_b(\alpha)} \leq 2\}$;
  \item
    $L = \{\alpha \in \{a,b\}^\star \mid \alpha = vuv\ \&\ \abs{u} \leq \abs{v}\}$;
  \item
    $L = \{\alpha \in \{a,b\}^\star \mid \alpha = uvv^R\ \&\ \abs{u} \leq \abs{v}\}$;
  \item
    $L = \{c^ka^nb^m \mid k,m,n > 0\ \&\ n \neq m\}$;
  \item
    $L = \{c^ka^nb^n \mid k > 0\ \&\ n \geq 0\}\cup\{a,b\}^\star$;
  \item
    $L = \{c^ka^nb^m\mid k,n,m \in \N\ \&\ k = 1\implies m = n\}$; % p \geq 2, не става с p = 1
  \end{enumerate}
\end{problem}
% \begin{proof}
%   \begin{enumerate}[1)]
%   \item
%     Разгледайте $w = a^pb^p$.
%   \item
%     Разгледайте $w = a^{p+1}b^p$.
%   \item
%     Езикът е регулярен.
%   \item
%     Подобно на 1) се доказва, че езикът не е регулярен.
%   \item
%     Да допуснем, че $L_5$ е регулярен и нека $w \in L_5$, така че $\abs{w} > p+1$.
%     $w = xyz$ и понеже $\abs{xy} \leq p$, то $\abs{z} > 1$.
%     Имаме, че $xy^iz \in L_5$ и следователно $\abs{xy^iz} = \abs{xz} + i.\abs{y}$ е просто число, за всяко $i$.
%     Да изберем $i = \abs{xz} > 1$.
%     Но тогава $\abs{xy^iz} = (1 + \abs{y})\abs{xz}$ е съставно число, следователно 
%     достигнахме до противоречие.
%   \item
%     Разгледайте $w = 0^p1^p$. Проблем с условието $\abs{xy} \leq p$.
%     Друг начин е да се използва, че $0^\star1^\star \cap L_6 = L_1$.
%   \item
%     Разгледайте $0^p10^p1$.
%   \item
    
%   \item
%     Да разгледаме $w = 1^{p^2}$.
%     Да допуснем, че $L_9$ е регулярен и имаме, че
%     \[(\forall i)[\abs{xy^iz}\ \&\ \abs{xy^{i+1}z}\mbox{ са точни квадрати}].\]
%     Тогава съществува $n$, за което $n^2 = \abs{xy^iz}$, $\abs{xy^{i+1}z} \geq (n+1)^2$ и
%     \[\abs{y} = \abs{xy^{i+1}z} - \abs{xy^{i}z} \geq 2n + 1 = 2\sqrt{\abs{xy^iz}} + 1\]
%     Ясно е, че $\abs{y} \leq \abs{w} = p^2$.
%     Получаваме, че за всяко $i$,
%     \[\abs{y} \geq 2\sqrt{\abs{xy^iz}} + 1\]
%     Лесно стигаме до противоречие, например да вземем $i = p^2$.
%     Тогава $\abs{y} > p$, което е противоречие.
%     % Да вземем $i = p^4$.
%     % $\abs{y} \leq p^2 < 2\sqrt{p^4} + 1 \leq 2\sqrt{\abs{xy^iz}} + 1$,
%     което е противоречие.
%   \item
%   \item
%   \item
%     Аналогично на 9).
%   \item
%     Да допуснем, че $L_{13}$ е регулярен.
%     Но тогава $L^\prime = \{a,b\}^\star \setminus L_{13}$ е регулярен
%     и $L_1 = a^\star b^\star \cap L^\prime$ е регулярен.
%     Достигнахме до противоречие.
%   \end{enumerate}
% \end{proof}


\begin{problem}
  Да означим $\mbox{Half}(L) = \{w\mid (\exists x \in \Sigma^\star)[wx \in L\ \&\ \abs{w} = \abs{x}]\}$.
  Докажете, че ако $L$ е регулярен език, то $\mbox{Half}(L)$ също е регулярен език.
\end{problem}

\begin{problem}
  Да означим $\mbox{Pref}(L) = \{\alpha \mid (\exists \beta \in \Sigma^\star)[\alpha\beta \in L]\}$.
  Докажете, че ако $L$ е регулярен език, то $\mbox{Pref}(L)$ също е регулярен език.
\end{problem}
\begin{proof}
  Две доказателства. Едното е с индукция по построението регулярния израз за $L$.
  Другото е по автомата за $L$.
\end{proof}


\section{Въпроси}

Вярно ли е, че:
\begin{itemize}
% \item
%   \marginpar{Не}
%   езикът $\{a^nb^n\mid n \in \Nat \}$ е регулярен?
% \item
%   \marginpar{Не}
%   езикът $\{a^nb^k\mid n > k\}$ е регулярен?
% \item
%   \marginpar{Не}
%   езикът $\{a^{n^2}\mid n \in \Nat\}$ е регулярен?
\item
  \marginpar{Да}
  за всеки два регулярни езика $R_1, R_2$, то $R_1 \setminus R_2$ е регулярен ?
\item
  \marginpar{Да}
  за всеки краен език $F$ и всеки регулярен $R$, то $R\setminus F$ е регулярен ?
\item
  \marginpar{Да}
  за всеки краен език $F$ и всеки рег. $R$, то $R\cup (\Sigma^\star \setminus F)$ е регулярен ?
\item
  \marginpar{Да}
  съществува регулярен език $R$ и нерегулярен $K$, за които $R\cap K$ не е регулярен ?
\item
  \marginpar{Да}
  съществува регулярен език $R$ и нерегулярен $K$, за които $R\setminus K$ не е регулярен ?
\item
  \marginpar{Не}
  за всеки регулярен език $R$ и всеки $K \subseteq R$, то $R\setminus K$ е регулярен ?
\end{itemize}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "discrete-math"
%%% End: 
